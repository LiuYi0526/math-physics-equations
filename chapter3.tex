\chapter{调和方程}

\section{建立方程,定解条件}

\begin{exercise}
  设 $u(x_1,\cdots,x_n)=f(r)$ (其中 $r=\sqrt{x_1^2+\cdots+x_n^2}$)
  是 $n$ 维调和函数 $\Bigl( \text{即满足方程\ }
  \frac{\partial^2u}{\partial x_1^2}+\cdots+\frac{\partial^2u}{\partial x_n^2}=0\Bigr)$,
  试证明
  \[f(r) = c_1+\frac{c_2}{r^{n-2}}\quad (n\geq 2),\]
  \[f(r) = c_1+c_2\ln\frac{1}{r}\quad (n=2),\]
  其中 $c_1$, $c_2$ 为任意常数.
\end{exercise}

\begin{proof}
  因为 $\frac{\partial u}{\partial x_i}=\frac{\diff f}{\diff r}\frac{x_i}{r}$,所以
  \[\frac{\partial^2u}{\partial x_i^2} =
    \frac{\diff^2f}{\diff r^2}\frac{x_i^2}{r^2}
    + \frac{\diff f}{\diff r}\frac{r^2-x_i^2}{r^3},\]
  故
  \[\sum_{i=1}^n\frac{\partial^2u}{\partial x_i^2}
    = \frac{\diff^2f}{\diff r^2}+\frac{\diff f}{\diff r}\frac{n-1}{r}
    = f''(r)+\frac{n-1}{r}f'(r)=0.\]
  由上式得
  \[f'=cr^{1-n}.\]
  \begin{enumerate}[(i)]
    \item $n = 2$ 时, $f(r)=c_1+c_2\ln r=c_1+c_2\ln\frac{1}{r}$,
    \item $n\neq 2$ 时, $f(r)=c_1+\frac{c_2}{2-n}r^{2-n}=c_1+\frac{c_2}{r^{n-2}}$,
  \end{enumerate}
  其中 $c_1$, $c_2$ 为任意常数.
\end{proof}


\begin{exercise}
  证明: 拉普拉斯算子在球坐标$(r,\theta,\varphi)$下可以写成
  \[\Delta u
    = \frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial u}{\partial r}\right)
    + \frac{1}{r^2\sin\theta}\frac{\partial}{\partial\theta}
      \left(\sin\theta\frac{\partial u}{\partial\theta}\right)
    +\frac{1}{r^2\sin^2\theta}\frac{\partial^2u}{\partial\varphi^2}.\]
\end{exercise}

\begin{proof}
  球坐标变换及其逆变换为
  \[\begin{cases}
    x = r\sin\theta\cos\varphi, \\
    y = r\sin\theta\sin\varphi, \\
    z = r\cos\theta;
  \end{cases}\Rightarrow
  \begin{cases}
    r = \sqrt{x^2+y^2+z^2}, \\
    \theta = \arccos\frac{z}{\sqrt{x^2+y^2+z^2}}, \\
    \varphi = \arctan\frac{y}{x}.
  \end{cases}\]
  通过链式法则可得
  \[\frac{\partial u}{\partial x}
    = \frac{\partial u}{\partial r}\frac{\partial r}{\partial x}
      + \frac{\partial u}{\partial\theta}\frac{\partial\theta}{\partial x}
      + \frac{\partial u}{\partial\varphi}\frac{\partial\varphi}{\partial x}.\]
  \[\frac{\partial^2u}{\partial x^2}
    = \frac{\partial^2u}{\partial r^2}\left(\frac{\partial r}{\partial x}\right)^2
      + \frac{\partial u}{\partial r}\frac{\partial^2r}{\partial x^2}
      + \frac{\partial^2u}{\partial\theta^2}\left(\frac{\partial\theta}{\partial x}\right)^2
      + \frac{\partial u}{\partial\theta}\frac{\partial^2\theta}{\partial x^2}
      + \frac{\partial^2u}{\partial\varphi^2}\left(\frac{\partial\varphi}{\partial x}\right)^2
      + \frac{\partial u}{\partial\varphi}\frac{\partial^2\varphi}{\partial x^2}.\]
  由逆变换公式求得 (所有求导项并未在下面完全列出, 因为很多项的形式是一样的)
  \[\frac{\partial r}{\partial x}
    = \frac{x}{r},\quad
    \frac{\partial^2r}{\partial x^2} = \frac{r^2-x^2}{r^3}.\]
  \[\frac{\partial\theta}{\partial x}
    = \frac{zx}{r^2\sqrt{x^2+y^2}},\quad
    \frac{\partial\theta}{\partial z}
    = \frac{-\sqrt{x^2+y^2}}{r^2}.\]
  \[\frac{\partial^2\theta}{\partial x^2}
    = \frac{zr^2y^2-2zx^2(x^2+y^2)}{r^4(x^2+y^2)^{3/2}},\quad
    \frac{\partial^2\theta}{\partial z^2}=\frac{2z\sqrt{x^2+y^2}}{r^4}\]
  \[\frac{\partial\varphi}{\partial x} = \frac{-y}{x^2+y^2},\quad
    \frac{\partial\varphi}{\partial y} = \frac{x}{x^2+y^2},\quad
    \frac{\partial\varphi}{\partial z}=0.\]
  \[\frac{\partial^2\varphi}{\partial x^2} = \frac{2xy}{(x^2+y^2)^2},\quad
    \frac{\partial^2\varphi}{\partial y^2}=\frac{-2xy}{(x^2+y^2)^2}.\]
  故
  \[\begin{split}
  \Delta u
    & = \frac{\partial^2u}{\partial r^2}\left[\left(\frac{\partial r}{\partial x}\right)^2
        + \left(\frac{\partial r}{\partial y}\right)^2
        + \left(\frac{\partial r}{\partial z}\right)^2\right]
        + \frac{\partial u}{\partial r}\left(\frac{\partial^2r}{\partial x^2}
        + \frac{\partial^2r}{\partial y^2}
        + \frac{\partial^2r}{\partial z^2}\right) \\
    & + \frac{\partial^2u}{\partial\theta^2}
        \left[\left(\frac{\partial\theta}{\partial x}\right)^2
        + \left(\frac{\partial\theta}{\partial y}\right)^2
        + \left(\frac{\partial\theta}{\partial z}\right)^2\right]
        + \frac{\partial u}{\partial\theta}\left(\frac{\partial^2\theta}{\partial x^2}
        + \frac{\partial^2\theta}{\partial y^2}+\frac{\partial^2\theta}{\partial z^2}\right) \\
    & + \frac{\partial^2u}{\partial\varphi^2}
        \left[\left(\frac{\partial\varphi}{\partial x}\right)^2
        + \left(\frac{\partial\varphi}{\partial y}\right)^2
        + \left(\frac{\partial\varphi}{\partial z}\right)^2\right]
        + \frac{\partial u}{\partial\varphi}\left(\frac{\partial^2\varphi}{\partial x^2}
        + \frac{\partial^2\varphi}{\partial y^2}
        + \frac{\partial^2\varphi}{\partial z^2}\right) \\
    & = \frac{\partial^2u}{\partial r^2}+\frac{\partial u}{\partial r}\frac{2}{r}
        + \frac{\partial^2u}{\partial\theta^2}\frac{1}{r^2}
        + \frac{\partial u}{\partial\theta}\frac{z}{r^2\sqrt{x^2+y^2}}
        + \frac{\partial^2u}{\partial\varphi^2}\frac{1}{x^2+y^2} \\
    & = \frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial u}{\partial r}\right)
        + \frac{1}{r^2\sin\theta}\frac{\partial}{\partial\theta}
        \left(\sin\theta\frac{\partial u}{\partial\theta}\right)
        + \frac{1}{r^2\sin^2\theta}\frac{\partial^2u}{\partial\varphi^2}.
  \end{split}\]
  证毕.
\end{proof}



\begin{exercise}
  证明: 拉普拉斯算子在柱坐标$(r,\theta,z)$下可以写成
  \[\Delta u
    = \frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial u}{\partial r}\right)
    + \frac{1}{r^2}\frac{\partial^2u}{\partial\theta^2}+\frac{\partial^2u}{\partial z^2}.\]
\end{exercise}

\begin{proof}
  柱坐标变换为
  \[\begin{cases}
    x = r\cos\theta, \\
    y = r\sin\theta, \\
    z = z.
  \end{cases}\]
  故
  \[\frac{\partial u}{\partial r}
    = \frac{\partial u}{\partial x}\cos\theta
      + \frac{\partial u}{\partial y}\sin\theta,\quad
    \frac{\partial u}{\partial\theta}
    = -\frac{\partial u}{\partial x}r\sin\theta
      + \frac{\partial u}{\partial y}r\cos\theta.\]
  \[\begin{split}
  \frac{\partial^2u}{\partial r^2}
    ={} & \left[\frac{\partial}{\partial x}\left(\frac{\partial u}{\partial x}\right)\cos\theta
          + \frac{\partial}{\partial y}\left(\frac{\partial u}{\partial x}\right)\sin\theta\right]\cos\theta \\
        & + \left[\frac{\partial}{\partial x}\left(\frac{\partial u}{\partial y}\right)\cos\theta
          + \frac{\partial}{\partial y}\left(\frac{\partial u}{\partial y}\right)\sin\theta\right]\sin\theta \\
    ={} & \frac{\partial^2u}{\partial x^2}\cos^2\theta
          + 2\frac{\partial^2u}{\partial x\partial y}\sin\theta\cos\theta
          + \frac{\partial^2u}{\partial y^2}\sin^2\theta.
  \end{split}\]
  \[\begin{split}
  \frac{\partial^2u}{\partial\theta^2}=
    & -\frac{\partial u}{\partial x}r\cos\theta-\frac{\partial u}{\partial y}r\sin\theta
      - \left[\frac{\partial}{\partial x}\left(\frac{\partial u}{\partial x}\right)(-r\sin\theta)
      + \frac{\partial}{\partial y}\left(\frac{\partial u}{\partial x}\right)r\cos\theta\right]r\sin\theta \\
    & + \left[\frac{\partial}{\partial x}\left(\frac{\partial u}{\partial y}\right)(-r\sin\theta)
      + \frac{\partial}{\partial y}\left(\frac{\partial u}{\partial y}\right)r\cos\theta\right]r\cos\theta \\
    ={} & -\frac{\partial u}{\partial x}r\cos\theta-\frac{\partial u}{\partial y}r\sin\theta
      + \frac{\partial^2u}{\partial\theta^2}r^2\sin^2\theta-2\frac{\partial^2u}{\partial x\partial y}r^2\sin\theta\cos\theta+\frac{\partial^2u}{\partial y^2}r^2\cos^2\theta.
  \end{split}\]
  故
  \begin{align*}
    \frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial u}{\partial r}\right)
      + \frac{1}{r^2}\frac{\partial^2u}{\partial\theta^2}
      + \frac{\partial^2u}{\partial z^2}
    & = \frac{1}{r}\frac{\partial u}{\partial r}+\frac{\partial^2u}{\partial r^2}
      + \frac{1}{r^2}\frac{\partial^2u}{\partial\theta^2} + \frac{\partial^2u}{\partial z^2} \\
    & = \frac{\partial^2u}{\partial x^2}+\frac{\partial^2u}{\partial y^2}
      + \frac{\partial^2u}{\partial z^2}=\Delta u. \qedhere
  \end{align*}
\end{proof}



\begin{exercise}
  证明下列函数都是调和函数:
  \begin{enumerate}[(1)]
    \item $ax+by+c$ ($a,b,c$ 为常数);
    \item $x^2-y^2$和$2xy$;
    \item $x^3-3xy^2$和$3x^2y-y^2$;
  \end{enumerate}
\end{exercise}

\begin{proof}
  直接验证即可.
\end{proof}



\begin{exercise}
  证明用极坐标表示的下列函数都满足调和方程:
  \begin{enumerate}[(1)]
    \item $\ln r$ 和 $\theta$;
    \item $r^n\cos n\theta$ 和 $r^n\sin n\theta$ ($n$为常数);
    \item $r\ln r\cos\theta-r\theta\sin\theta$ 和 $r\ln r\sin\theta+r\theta\cos\theta$.
  \end{enumerate}
\end{exercise}

\begin{proof}
  极坐标下的 Laplace 算子为
  \[\Delta u = \frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial u}{\partial r}\right)
    + \frac{1}{r^2}\frac{\partial^2u}{\partial\theta^2}.\]
  代入验证 $\Delta u=0$ 即可.
\end{proof}


\begin{exercise}
  用分离变量法求解由下述调和方程的第一边值问题所描述的矩阵平板 ($0\leq x\leq a,0\leq y\leq b$)
  上的稳定温度分布:
  \[\begin{cases}
    \frac{\partial^2u}{\partial x^2}+\frac{\partial^2u}{\partial y^2}=0,\\
    u(0,y)=u(a,y)=0,\\
    u(x,0)=\sin\frac{\pi x}{a},u(x,b)=0.
  \end{cases}\]
\end{exercise}

\begin{solve}
  令 $u(x,y)=X(x)Y(y)$, 代入 $\Delta u=0$ 得
  \[\frac{X''(x)}{X(x)} = -\frac{Y''(y)}{Y(y)} = \lambda.\]
  由于 $u(x,0) = X(x)Y(0) = \sin\frac{\pi x}{a}$, 故 $X(x) = C\sin\frac{\pi x}{a}$ 且求导得
  \[\frac{X''(x)}{X(x)} = \lambda = -\biggl(\frac{\pi}{a}\biggr)^2.\]
  所以
  \[Y''(y) - \biggl(\frac{\pi}{a}\biggr)^2 Y(y) = 0.\]
  解得
  \[Y(y) = C_1 \e^{\frac{\pi}{a}y} + C_2 \e^{-\frac{\pi}{a}y},\]
  结合边界条件 $Y(b) = 0$ 得
  \[Y(y) = C_3 \Bigl(\e^{\frac{(y-b)\pi}{a}} - \e^{\frac{(b-y)\pi}{a}}\Bigr)
    = 2C_3 \sinh\frac{(y-b)\pi}{a}.\]
  于是
  \[u(x,y) = X(x)Y(y) = C_4 \sinh\frac{(y-b)\pi}{a} \sin\frac{\pi x}{a}.\]
  结合 $u(x,0) = \sin\frac{\pi x}{a}$, 得
  \[u(x,y) = \frac{\sinh \frac{(y-b)\pi}{a}}{\sin h \frac{-b\pi}{a}} \sin\frac{\pi x}{a}.\qedhere\]
\end{solve}


\begin{exercise}
  在膜型扁壳渠道闸门的设计中, 为了考察闸门在水压力作用下的受力情况, 要在矩形区域
  $0\leq x\leq a$, $0\leq y\leq b$ 上求解如下的非齐次调和方程的边值问题:
  \[\begin{cases}
    \Delta u = py+q\quad (p<0, q>0\text{\ 常数}), \\
    \displaystyle\frac{\partial u}{\partial x}\biggm|_{x=0} = 0,\ u|_{x=a} = 0, \\
    u|_{y=0,y=b} = 0.
  \end{cases}\]
  试求解之.
\end{exercise}

\begin{solution}
  令 $v = u + (x^2-a^2)(fy+g)$, 通过选取 $f = -p/2$, $g = -q/2$, 则 $v$ 满足方程
  \[\begin{cases}
    \Delta v = 0, \\
    v_x|_{x=0} = v|_{x=a} = 0, \\
    v|_{y=0} = -\frac{q}{2}(x^2-a^2) = \alpha(x), \\
    v|_{y=b} = -\frac{1}{2}(bp+q)(x^2-a^2) = \beta(x).
  \end{cases}\]
  再利用分离变量法求解即可.
\end{solution}


\begin{exercise}
  举例说明在二维 Laplace 方程的 Dirichlet 外问题中, 如对解 $u(x,y)$ 不加在无穷远处
  为有界的限制, 那么定解问题的解不是唯一的.
\end{exercise}

\begin{proof}
  考虑区域 $\varOmega = \{(x,y)\mid x^2+y^2 > 1\}$ 以及相应的 Dirichlet 外问题
  \[\Delta u = 0\text{ in }\varOmega,\quad u = 1\text{ on }\partial\varOmega.\]
  显然 $u\equiv 1$ 和 $u = c\ln\frac{1}{r}+1$ 都为对应的解.
\end{proof}


\begin{exercise}
  设
  \[J(u) = \iiint_{\varOmega} \frac12 \biggl[\biggl(\frac{\partial u}{\partial x}^2\biggr)
    + \biggl(\frac{\partial u}{\partial y}^2\biggr)
    + \biggl(\frac{\partial u}{\partial z}^2\biggr)\biggr] \diff x\diff y\diff z
    + \iint_{\varGamma} \biggl(\frac12 \sigma u^2 - gu\biggr) \diff s,\]
  变分问题的提法为: 求 $u\in V$, 使
  \[J(u) = \min_{v\in V} J(v),\]
  其中 $V = C^2(\varOmega)\cap C^1(\closure{\varOmega})$.
  试导出与此变分问题等价的边值问题, 并证明它们的等价性.
\end{exercise}

\begin{proof}
  等价的边值问题为
  \[\begin{cases}
    \Delta u = 0, \\
    \Bigl(\frac{\partial u}{\partial \bm{n}} + \sigma u\Bigr)\Bigm|_{\varGamma} = g.
  \end{cases}\]
\end{proof}



\section{格林公式及其应用}

\begin{exercise}
  证明 (2.7) 式对于 $M_0$ 在 $\varOmega$ 外与 $\Gamma$ 上的情形成立.
\end{exercise}

\begin{proof}
  当 $M_0$ 在 $\varOmega$ 外时, $v=\frac{1}{r_{M_0M}}$ 在区域 $\varOmega$ 内无奇异点, 故由格林第二公式得
  \[\iiint_{\varOmega} \left(u\Delta\frac{1}{r}-\frac{1}{r}\Delta u\right)\diff V
    = \iint_{\Gamma}\left(u\frac{\partial}{\partial\vec{n}}\left(\frac{1}{r}\right)
      - \frac{1}{r}\frac{\partial u}{\partial\vec{n}}\right) \diff S.\]
  在 $\varOmega$ 内 $\Delta u=0$, $\Delta\frac{1}{r}=0$, 故
  \[-\iint_{\Gamma}\left(u\frac{\partial}{\partial\vec{n}}\left(\frac{1}{r}\right)
    - \frac{1}{r}\frac{\partial u}{\partial\vec{n}}\right)\diff S = 0.\]

  当 $M_0$ 在 $\Gamma$ 上时, 将以 $M_0$ 为球心, 
  以充分小正数 $\varepsilon$ 为半径的球与 $\varOmega$ 相交的部分记为 $K_{\varepsilon}$,
  将 $K_{\varepsilon}$ 的包含于 $\varOmega$ 内的边界记为 $\Gamma_{\varepsilon}$,
  且记 $\partial(\varOmega\backslash K_{\varepsilon})-\Gamma_{\varepsilon}=\Gamma_{\varepsilon}'$,
  则由格林第二公式得
  \[0 = \iiint_{\varOmega\backslash K_{\varepsilon}}
    \left(u\Delta\frac{1}{r} - \frac{1}{r}\Delta u\right)\diff V
    = \iint_{\Gamma_{\varepsilon}\bigcup\Gamma_{\varepsilon}'} \left(u\frac{\partial}{\partial\vec{n}}
      \left(\frac{1}{r}\right)-\frac{1}{r}\frac{\partial u}{\partial\vec{n}}\right) \diff S.\]
  故
  \[-\iint_{\Gamma_{\varepsilon}'} \left(u\frac{\partial}{\partial\vec{n}}\left(\frac{1}{r}\right)
    -\frac{1}{r}\frac{\partial u}{\partial\vec{n}}\right) \diff S
    = \iint_{\Gamma_{\varepsilon}}\left(u\frac{\partial}{\partial\vec{n}}
      \left(\frac{1}{r}\right) - \frac{1}{r}\frac{\partial u}{\partial\vec{n}}\right)\diff S.\]
  而
  \[\iint_{\Gamma_{\varepsilon}} \left(u\frac{\partial}{\partial\vec{n}}\left(\frac{1}{r}\right)
    -\frac{1}{r}\frac{\partial u}{\partial\vec{n}}\right) \diff S
    = \iint_{\Gamma_{\varepsilon}}\left(\frac{u}{\varepsilon^2}
      - \frac{1}{\varepsilon}\frac{\partial u}{\partial\vec{n}}\right) \diff S.\]
  令 $\varepsilon\to 0$, 注意到 $\Gamma$ 充分光滑
  (这意味着面积 $S(\Gamma_{\varepsilon})\to 2\pi\varepsilon^2$), 所以有
  \[\lim_{\varepsilon\to 0} \iint_{\Gamma_{\varepsilon}}
    \left(\frac{u}{\varepsilon^2}-\frac{1}{\varepsilon}\frac{\partial u}{\partial\vec{n}}\right)\diff S
    = 2\pi u(M_0).\]
  同时 $\lim_{\varepsilon\to0}\Gamma_{\varepsilon}'=\Gamma$, 因此最终得到
  \[-\iint_{\Gamma} \left(u\frac{\partial}{\partial\vec{n}}\left(\frac{1}{r}\right)-\frac{1}{r}
    \frac{\partial u}{\partial\vec{n}}\right)\diff S = 2\pi u(M_0). \qedhere\]
\end{proof}


\begin{exercise}
  若函数 $u(x,y)$ 是单位圆周上的调和函数, 又它在单位圆周上的数值已知为 $u=\sin\theta$,
  其中 $\theta$ 表示极角, 问函数 $u$ 在原点之值等于多少?
\end{exercise}

\begin{proof}
  由平均值公式知原点之值为
  \[u(O) = \frac{1}{2\pi}\int_{\Gamma}\sin\theta\diff s
    = \frac{1}{2\pi}\int_0^{2\pi}\sin\theta\diff\theta = 0.\qedhere\]
\end{proof}


\begin{exercise}[4]
  证明: 当 $u(M)$ 在闭曲面 $\Gamma$ 的外部调和, 并且在无穷远处成立
  \[u(M) = O\biggl(\frac{1}{r_{OM}}\biggr),\quad
    \frac{\partial u}{\partial r} = O\biggl(\frac{1}{r_{OM}^2}\biggr)\quad
    (r_{OM}\to\infty),\]
  而 $M_0$ 是 $\Gamma$ 外任意一点, 则公式 (2.6) 仍成立.
\end{exercise}

\begin{proof}
  取以 $M_0$ 为球心, 以 $R$ (充分大)为半径的球 $K_R$ 使其包含曲面 $\Gamma$,
  并记该球去掉闭曲面 $\Gamma$ 内部区域后得到的部分为 $\varOmega_R$. 将 $K_R$ 的边界记为 $\Gamma_R$,
  再取以 $M_0$ 为球心, 以 $\epsilon$ 为半径的球 $K_{\epsilon}$ 使其完全包含在区域 $\varOmega_R$中,
  将 $K_{\epsilon}$ 的边界记为 $\Gamma_{\epsilon}$.
  取 $r=r_{MM_0}$, 则由格林第二公式得
  \begin{equation}
    \begin{aligned}
    0 & = \iiint_{\varOmega_R\backslash K_{\epsilon}}\left(u\Delta\frac{1}{r}
        - \frac{1}{r}\Delta u\right)\diff V \\
      & = \iint_{\Gamma\bigcup\Gamma_R\bigcup\Gamma_{\epsilon}}\left(u\frac{\partial}{\partial\vec{n}}\left(\frac{1}{r}\right)-\frac{1}{r}\frac{\partial u}{\partial\vec{n}}\right)\diff S.
    \end{aligned} \tag{$\star$}
  \end{equation}
  因为 $u(M)=O(\frac{1}{r})$, $\frac{\partial u}{\partial r}=O(\frac{1}{r^2})$ $(r\to\infty)$,
  所以当 $R\to +\infty$ 时,
  \[\iint_{\Gamma_R}\left(u\frac{\partial}{\partial\vec{n}}\left(\frac{1}{r}\right)
    - \frac{1}{r}\frac{\partial u}{\partial\vec{n}}\right)\diff S
    = \iint_{\Gamma_R}\left(\frac{-u}{R^2}-\frac{1}{R}\frac{\partial u}{\partial r}\right)\diff S = 0.\]
  又因为当 $\epsilon\to 0$ 时,
  \[\iint_{\Gamma_{\epsilon}}\left(u\frac{\partial}{\partial\vec{n}}\left(\frac{1}{r}\right)
    - \frac{1}{r}\frac{\partial u}{\partial\vec{n}}\right)\diff S
    = \iint_{\Gamma_{\epsilon}}\left(\frac{u}{\epsilon^2}
    + \frac{1}{\epsilon}\frac{\partial u}{\partial r}\right)\diff S
    \to 4\pi u(M_0).\]
  在 ($\star$) 式中令 $R\to +\infty$, $\epsilon\to 0$, 即得
  \[u(M_0)
  =-\frac{1}{4\pi}\iint_{\Gamma}\left(u\frac{\partial}{\partial\vec{n}}\left(\frac{1}{r}\right)
  -\frac{1}{r}\frac{\partial u}{\partial\vec{n}}\right)\diff S. \qedhere\]
\end{proof}


\begin{exercise}
  证明调和方程 Dirichlet 外问题解的稳定性.
\end{exercise}

\begin{proof}
  在闭曲面 $\Gamma$ 上给定两个函数 $f,f^*$, 并且在$\Gamma$上满足$|f-f^*|\leq\epsilon$,
  设 $u,u^*$ 是相应的狄利克雷外问题的解, 以 $\Gamma_R$ 表示半径为 $R$ 的球面, 令$v=u-u^*$, 因为
  \[\lim_{r\to\infty}v(x,y,z)=0.\]
  所以存在 $R_0$, 使得在 $\Gamma_{R_0}$ 及其外部满足 $|v|\leq\epsilon$,
  在 $\Gamma$ 和 $\Gamma_{R_0}$ 围成的有界区域中,
  利用极值原理知 $|v|\leq\epsilon$, 故在 $\Gamma$ 的外部满足 $|v|\leq\epsilon$,
  由此证明了狄利克雷外问题的解是稳定的.
\end{proof}


\begin{exercise}
  对于二阶偏微分方程
  \[\sum_{i,j=1}^n a_{ij} u_{x_ix_j} + \sum_{i=1}^n b_i u_{x_i} + cu = 0,\]
  其中 $a_{ij}$, $b_i$, $c$ ($i,j=1,\dots,n$) 均为常数. 假设存在常数 $\lambda>0$, 使得
  \[\sum_{i,j=1}^n a_{ij}\xi_i\xi_j \geq \lambda |\xi|^2,\quad \forall\xi\in\mathbb{R}^n.\]
  又设 $c>0$, 证明极值原理: 若 $u$ 在 $\varOmega$ 中满足方程, 在 $\varOmega\cup\Gamma$ 上连续,
  则 $u$ 不能在 $\varOmega$ 的内部达到正的最大值或负的最小值.
\end{exercise}

\begin{proof}
  假设 $u$ 在点 $x_0\in\varOmega$ 处达到正的最大值, 则
  \[\nabla u(x_0) = 0,\qquad (D_{ij} u(x_0))\leq 0.\]
  因此
  \[\sum_{i,j=1}^n a_{ij} u_{x_ix_j}(x_0) \leq 0,
    \quad \sum_{i=1}^n b_i u_{x_i}(x_0) = 0,\quad cu(x_0)<0.\]
  从而
  \[\sum_{i,j=1}^n a_{ij} u_{x_ix_j}(x_0) + \sum_{i=1}^n b_i u_{x_i}(x_0) + cu(x_0) <0,\]
  与条件矛盾.
\end{proof}


\section{格林函数}

\[u(M_0) = \iint_{\Gamma}\left[\frac{1}{4\pi r_{M_0M}}\frac{\partial u}{\partial\vec{n}}-u\frac{\partial}{\partial\vec{n}}\frac{1}{4\pi r_{M_0M}}\right]\diff S_M\]
\[\iint_{\Gamma}\left(g\frac{\partial u}{\partial\vec{n}}-u\frac{\partial g}{\partial\vec{n}}\right)\diff S_M=0\]
相减得
\[u(M_0)=\iint_{\Gamma}\left(G\frac{\partial u}{\partial\vec{n}}-u\frac{\partial G}{\partial\vec{n}}\right)\diff S_M,\mbox{其中}G(M,M_0)=\frac{1}{4\pi r_{M_0M}}-g(M,M_0)\]

\begin{note}
  格林函数的五点性质的证明.

  \begin{property}
    格林函数 $G(M, M_0)$ 除 $M=M_0$ 一点外处处满足方程 (1.1), 而当 $M\to M_0$ 时,
    $G(M, M_0)$ 趋于无穷大, 其阶数和 $\frac{1}{4\pi r_{M_0M}}$ 相同.
  \end{property}

  \begin{proof}
    除了点$M=M_0$外,$\frac{1}{4\pi r_{M_0M}}$调和,又因为$g(M,M_0)$在$\varOmega$内调和,故$G(M,M_0)$除了$M=M_0$外处处调和,由极值原理知$g(M,M_0)$在$\varOmega$上有界,故
    \[\lim_{M\to M_0}G(M,M_0)=\lim_{M\to M_0}\left(\frac{1}{4\pi r_{M_0M}}-g(M,M_0)\right)=\infty\mbox{且和}\frac{1}{4\pi r_{M_0M}}\mbox{同阶}\]
  \end{proof}

  \begin{property}
    在边界上格林函数 $G(M, M_0)$ 恒等于零.
  \end{property}

  \begin{proof}
    由$g(M,M_0)$的定义知$G(M,M_0)|_{\Gamma}=0$.
  \end{proof}

  \begin{property}
    在区域 $\varOmega$ 上成立着不等式:
    \[0 < G(M, M_0) < \frac{1}{4\pi r_{M_0M}}.\]
  \end{property}
  
  \begin{proof}
    \[0<G(M,M_0)<\frac{1}{4\pi r_{M_0M}}\Leftrightarrow 0<g(M,M_0)<\frac{1}{4\pi r_{M_0M}}\]
    由极值原理知$g(M,M_0)>0$是显然的,下面证明$g(M,M_0)<\frac{1}{4\pi r_{M_0M}}$:

    取$\delta$足够小使得$\frac{1}{4\pi r_{M_0M}}>g(M,M_0)$在$B(M_0,\delta)$上成立(这样的$\delta$显然是可以取到的),记$D=\varOmega\backslash\overline{B(M_0,\delta)}$,则$\frac{1}{4\pi r_{M_0M}}-g(M,M_0)$在$D$上调和,且
    \[\min_{\partial D}\left(\frac{1}{4\pi r_{M_0M}}-g(M,M_0)\right)=0\]
    故由极值原理知在$D$上成立$\frac{1}{4\pi r_{M_0M}}>g(M,M_0)$,从而在$\varOmega$上成立$\frac{1}{4\pi r_{M_0M}}>g(M,M_0)$.
  \end{proof}

  \begin{property}
    格林函数 $G(M, M_0)$ 在自变量 $M$ 及参变量 $M_0$ 之间具有对称性, 即设
    $M_1$, $M_2$ 为区域中的亮两点, 则
    \[G(M_1, M_2) = G(M_2, M_1).\]
  \end{property}
  
  \begin{proof}
    记$D_{\epsilon}=\varOmega\backslash(B(M_1,\epsilon)\bigcup B(M_2,\epsilon))$,
    再记$w(M)=G(M,M_2),v(M)=G(M,M_1)$,则我们要证明$w(M_1)=v(M_2)$,
    由定义知$w(M)$和$v(M)$都是$D_{\epsilon}$上的调和函数,故由格林公式得
    \[\iint_{\partial D_{\epsilon}}\left(w\frac{\partial v}{\partial\vec{n}}-v\frac{\partial w}{\partial\vec{n}}\right)\diff S=0\]
    故
    \[\iint_{\partial B(M_1,\epsilon)}\left(w\frac{\partial v}{\partial\vec{n}}-v\frac{\partial w}{\partial\vec{n}}\right)\diff S=\iint_{\partial B(M_2,\epsilon)}\left(v\frac{\partial w}{\partial\vec{n}}-w\frac{\partial v}{\partial\vec{n}}\right)\diff S\]
    当$\epsilon\to0+$时,在$\partial B(M_1,\epsilon)$上,$v=O(\frac{1}{\epsilon}),\frac{\partial v}{\partial\vec{n}}=O(\frac{1}{\epsilon^2}),\frac{\partial v}{\partial\vec{n}}=-\frac{1}{4\pi\epsilon^2}+\mbox{有界量}$,故
    \[\iint_{\partial B(M_1,\epsilon)}w\frac{\partial v}{\partial\vec{n}}\diff S=\iint_{\partial B(M_1,\epsilon)}-\frac{1}{4\pi\epsilon^2}w\diff S+\iint_{\partial B(M_1,\epsilon)}\mbox{有界量}\cdot w\diff S\to-w(M_1)\]取极限$\epsilon\to0+$,即得$w(M_1)=v(M_2)$.
  \end{proof}

  \begin{property}
    $\iint_{\varGamma} \frac{\partial G(M, M_0)}{\partial n} \diff S_M = -1$.
  \end{property}
  
  \begin{proof}
    设 $\Gamma_{\epsilon}$ 是以 $M_0$为球心,
    以 $\epsilon$ 为半径的球面, 并且其包含在 $\varOmega$ 当中, 则
    \[\begin{split}
      \iint_{\Gamma}\frac{\partial G(M,M_0)}{\partial\vec{n}}\diff S_M
      & = \iint_{\Gamma}\frac{\partial}{\partial\vec{n}}\left(\frac{1}{4\pi r_{M_0M}}\right)\diff S_M-\iint_{\Gamma}\frac{\partial g(M,M_0)}{\partial\vec{n}}\diff S_M \\
      & = \iint_{\Gamma}\frac{\partial}{\partial\vec{n}}
          \left(\frac{1}{4\pi r_{M_0M}}\right)\diff S_M\quad (\text{Theorem 2.1}) \\
      & = \iint_{\Gamma_{\epsilon}}\frac{\partial}{\partial\vec{n}}
          \left(\frac{1}{4\pi r_{M_0M}}\right)\diff S_M\quad (\text{Theorem 2.1}) \\
      & = \iint_{\Gamma_{\epsilon}}\frac{-1}{4\pi\epsilon^2}\diff S_M = -1.
    \end{split}\]
    另法:考虑定解问题(老师上课时解法)
    \[\begin{cases}
    \Delta u=0(in\;\varOmega)\\u|_{\Gamma=1}
    \end{cases}\]
    由极值原理知解为$u\equiv1$,代入(3.4)式即得结论
  \end{proof}

  二维情形圆的格林函数取为$G(M,M_0)=\frac{1}{2\pi}\left(\ln\frac{1}{r_{M_0M}}-\ln\frac{R}{\rho_0}\frac{1}{r_{M_1M}}\right)$也是为了使得$\int_{\Gamma}\frac{\partial G(M,M_0)}{\partial\vec{n}}\diff s=-1$成立,证明思路同上.
\end{note}



\begin{exercise}[5]
  求半圆区域上狄利克雷问题的格林函数.
\end{exercise}

\begin{solve}
  设上半圆区域为 $D$, 半径为$R$, $A(x_0,y_0)\in D,M(x,y)\in D$,
  点 $A$ 关于边界圆的反演点为 $A_1(R^2\frac{x_0}{\sqrt{x_0^2+y_0^2}}$,
  $R^2\frac{y_0}{\sqrt{x_0^2+y_0^2}})$,
  记 $A$ 与 $A_1$ 关于 $x$ 轴的对称点分别为 $A_2$, $A_3$,
  再记 $MA=r$, $MA_1=r_1$, $MA_2=r_2$, $MA_3=r_3$, 则格林函数为
  \[G(M,M_0)=\frac{1}{2\pi}\ln\frac{r_1r_2}{rr_3}.\qedhere\]
\end{solve}


\begin{exercise}[7]
  证明二维调和函数的可去奇点定理:
  若 $A$ 是调和函数 $u(M)$ 的孤立奇点, 在 $A$ 点邻域中成立着
  \[u(M) = o\biggl(\ln\frac{1}{r_{AM}}\biggr),\]
  则此时可以重新定义 $u(M)$ 在 $M=A$ 的值, 使它在 $A$ 点也是调和的.
\end{exercise}

\begin{proof}
  设 $K$ 是以 $A$ 为圆心, 以$R$为半径的圆,并且其完全包含在$A$的那个所考察的邻域中,
  以 $u$ 在 $K$ 上的值为边界条件, 在 $K$ 内求拉普拉斯方程的解,记为 $v$,
  下面证明在整个 $K$ 内除了点 $A$ 外 $u=v$, 令 $w=u-v$, 则
  \[\lim_{M\to A}\frac{w(M)}{\ln\frac{1}{r_{AM}}}=0.\]
  此外在圆 $K$ 的边界上 $w=0$. 作函数
  \[w_{\epsilon}(M) = \epsilon\left(\ln\frac{1}{r_{AM}}-\ln\frac{1}{R}\right).\]
  具有如下的性质: (1)在$K$的边界上$w_{\epsilon}(M)=0$;在$K$内$w_{\epsilon}(M)>0$.
  (2) 在$r=\delta$和$r=R$所包围的同心圆环上是调和函数,这里$\delta$是任意小的正数.
  因为
  \[\lim_{M\to A}\frac{w_{\epsilon}(M)}{\ln\frac{1}{r_{AM}}}=\epsilon,\]
  所以存在 $\delta'$, 使得当 $r_{AM}<\delta'$时
  \[\frac{w_{\epsilon}(M)}{\ln\frac{1}{r_{AM}}}>\frac{\epsilon}{2}.\]
  又因为
  \[\lim_{M\to A}\frac{w(M)}{\ln\frac{1}{r_{AM}}}=0,\]
  所以存在 $\delta''$,使得当$r_{AM}<\delta''$时
  \[\left|\frac{w(M)}{\ln\frac{1}{r_{AM}}}\right|<\frac{\epsilon}{2}\]
  令$\delta=\min(\delta',\delta'')$,则在圆$r_{AM}=\delta$上有
  \[\left|\frac{w(M)}{\ln\frac{1}{r_{AM}}}\right|
    \leq\frac{w_{\epsilon}(M)}{\ln\frac{1}{r_{AM}}}\Rightarrow|w(M)|\leq w_{\epsilon}(M).\]
  故由极值原理推论2知对于 $r=\delta$ 和 $r=R$ 所包围的同心圆环中的任意一点 $M$, 成立
  \[|w(M)|\leq w_{\epsilon}(M).\]
  令 $\epsilon\to0$, 即得 $w(M)=0,\forall M\in K\backslash A$.
\end{proof}


\begin{exercise}
  证明: 如果三维调和函数 $u(M)$ 在奇点 $A$ 附近表示成 $\frac{N}{r_{AM}^{\alpha}}$,
  其中常数 $0<\alpha\leq 1$, 而 $N$ 是不为零的光滑函数, 则当 $M\to A$ 时它趋于
  无穷大的阶数必与 $\frac{1}{r_{AM}}$ 同阶, 即 $\alpha=1$.
\end{exercise}

\begin{proof}
  假设$\alpha<1$,则
  \[\lim_{M\to A}r_{AM}u(M) = \lim_{M\to A}Nr_{AM}^{1-\alpha} = 0.\]
  由可去奇点定理知 $A$ 是可去奇点, 矛盾, 故 $\alpha=1$.
\end{proof}


\begin{exercise}
  Try to find a function $u$ such that it is harmonic in a circle of radius $\alpha$
  and takes the following values on the boundary $C$:
  \begin{enumerate}[(1)]
    \item $u|_C = A\cos\varphi$;
    \item $u|_C = A + B\sin\varphi$.
  \end{enumerate}
\end{exercise}

9.解:利用泊松公式(3.13)式
\[u(\rho_0,\varphi_0)=\frac{1}{2\pi}\int_0^{2\pi}\frac{(R^2-\rho_0^2)f(\varphi)}{R^2+\rho_0^2-2R\rho_0\cos(\varphi-\varphi_0)}\diff\varphi\]
(1)\[\begin{split}
u(\rho_0,\varphi_0)&=\frac{1}{2\pi}\int_0^{2\pi}\frac{(R^2-\rho_0^2)A\cos(\varphi)}{R^2+\rho_0^2-2R\rho_0\cos(\varphi-\varphi_0)}\diff\varphi\\
&=\frac{A(R^2-\rho_0^2)}{2\pi}\int_0^{2\pi}\frac{\cos(\varphi)}{R^2+\rho_0^2-2R\rho_0\cos(\varphi-\varphi_0)}\diff\varphi\\
&=\frac{A(R^2-\rho_0^2)}{2\pi}\int_{0}^{2\pi}\frac{\cos(\theta+\varphi_0)}{R^2+\rho_0^2-2R\rho_0\cos\theta}\diff\theta(\mbox{换元}\theta=\varphi-\varphi_0)\\
&=\frac{A(R^2-\rho_0^2)}{2\pi}\int_{-\pi}^{\pi}\frac{\cos\theta\cos\varphi_0-\sin\theta\sin\varphi_0}{R^2+\rho_0^2-2R\rho_0\cos\theta}\diff\theta\\
&=\frac{A(R^2-\rho_0^2)}{2\pi}\int_{-\pi}^{\pi}\frac{\cos\theta\cos\varphi_0}{R^2+\rho_0^2-2R\rho_0\cos\theta}\diff\theta\\
&=\frac{2A(R^2-\rho_0^2)\cos\varphi_0}{2\pi}\int_0^{\pi}\frac{\cos\theta}{R^2+\rho_0^2-2R\rho_0\cos\theta}\diff\theta\\
&=\frac{2A(R^2-\rho_0^2)\cos\varphi_0}{2\pi}\frac{\pi\rho_0}{R(R^2-\rho_0^2)}\\
&=\frac{A}{R}\rho_0\cos\varphi_0=\frac{A}{\alpha}\rho_0\cos\varphi_0
\end{split}\]
故\[u(\rho,\varphi)=\frac{A}{\alpha}\rho\cos\varphi\]
(2)因为$u|_C=A+B\sin\varphi=A+B\cos(\varphi-\frac{\pi}{2})$,故由叠加原理及(1)中结果知
\[u(\rho,\varphi)=A+\frac{B}{\alpha}\rho\cos\left(\varphi-\frac{\pi}{2}\right)=A+\frac{B}{\alpha}\rho\sin\varphi\]


\begin{exercise}
  Derive the solution of the Dirichlet problem of 2-dimensional Laplace
  equation in the half plane:
  \[\begin{cases}
    \Delta u = u_{xx} + u_{yy} = 0, \quad y>0, \\
    u|_{y=0} = f(x).
  \end{cases}\]
\end{exercise}

\begin{solve}
  \[G(M,M_0)=\frac{1}{2\pi}\left[\ln\frac{1}{\sqrt{(x-x_0)^2+(y-y_0)^2}}-\ln\frac{1}{\sqrt{(x-x_0)^2+(y+y_0)^2}}\right]\]
  注意到$\frac{\partial}{\partial\vec{n}}=-\frac{\partial}{\partial y}$,故
  \[\begin{split}
  u(x_0,y_0)&=-\int_{\Gamma}f(x)\frac{\partial G(M,M_0)}{\partial\vec{n}}\diff x\\
  &=\frac{1}{2\pi}\int_{-\infty}^{\infty}f(x)\frac{\partial}{\partial y}\left[\ln\frac{1}{\sqrt{(x-x_0)^2+(y-y_0)^2}}-\ln\frac{1}{\sqrt{(x-x_0)^2+(y+y_0)^2}}\right]\Bigg|_{y=0}\diff x\\
  &=\frac{1}{2\pi}\int_{-\infty}^{\infty}f(x)\left(-\frac{1}{2}\frac{2(y-y_0)}{(x-x_0)^2+(y-y_0)^2}+\frac{1}{2}\frac{2(y+y_0)}{(x-x_0)^2+(y+y_0)^2}\right)\bigg|_{y=0}\diff x\\
  &=\frac{1}{\pi}\int_{-\infty}^{\infty}f(x)\frac{y_0}{(x-x_0)^2+y_0^2}\diff x
  \end{split}\]
  因此二维调和方程在半平面上的狄利克雷问题的解为:
  \[u(x,y)=\frac{1}{\pi}\int_{-\infty}^{\infty}\frac{f(\xi)y}{(\xi-x)^2+y^2}\diff\xi. \qedhere\]
\end{solve}


\section{强极值原理,第二边值问题解的唯一性}

\begin{exercise}
  试用强极值原理来证明极值原理: 对不恒等于常数的调和函数$u(x,y,z)$,
  其在区域 $\varOmega$ 的任何内点上的值不可能达到它在 $\varOmega$ 上的上界或下界.
\end{exercise}

\begin{proof}
  假设调和函数 $u(x,y,z)$ 不恒等于常数, 且在区域 $\varOmega$ 内部某点达最小值 $m$, 记
  \[E = \{ M\in\varOmega \mid u(M) = m\}.\]
  则由 $u$ 的连续性知 $E$ 是相对闭集, 由于 $u$ 不恒为常数, 故 $\varOmega\setminus E$ 为非空开集,
  取点 $M_0\in\varOmega\setminus E$ 使得 $\dist(M_0, E) < \dist(M_0, \partial\varOmega)$.
  取以点 $M_0$ 为球心, 以 $\dist(M_0, E)$ 为半径的球 $B$, 取 $M_1\in \partial B\cap E$.
  对于 $B$ 内任一点 $M$ 均有 $u(M)>u(M_1)$, 故由强极值原理
  \[\frac{\partial u}{\partial\vec{\nu}}\bigg|_{M_1} > 0,\]
  其中 $\vec{\nu}$ 与 $B$ 在点 $M_1$ 处的内法线方向成锐角,
  但是由于 $M_1$ 是 $\varOmega$ 内部的最小值点, 故对于任意方向 $\vec{l}$ 均有
  \[\frac{\partial u}{\partial\vec{l}}\bigg|_{M_1} = 0.\]
  矛盾.
\end{proof}


\begin{exercise}
  利用极值原理和强极值原理证明: 当区域 $\varOmega$ 的边界 $\varGamma$
  满足定理 4.2 中的条件时, 调和方程第三边值问题
  \[\biggl(\frac{\partial u}{\partial \bm{n}} + \sigma u\biggr)\bigg|_{\varGamma}
    = f \quad (\sigma>0)\]
  的解的唯一性.
\end{exercise}

\begin{proof}
  只需要证明满足边界条件 $(\frac{\partial u}{\partial\bm{n}}+\sigma u)|_{\varGamma}=0$ 的只有零解即可,
  下面分两种情况讨论.

  对于第三边值问题的内问题: 假设 $u$ 不恒为常数, 则由极值原理知 $u$ 在 $\varGamma$ 上取得最大值和最小值,
  记在 $M_1$ 处取到最小值, 在 $M_2$ 处取得最大值, 则
  \[\frac{\partial u}{\partial\bm{n}}(M_1) + \sigma u(M_1) = 0
    \Rightarrow u(M_1) = -\frac{1}{\sigma}\frac{\partial u}{\partial\bm{n}}(M_1)>0.\]
  \[\frac{\partial u}{\partial\bm{n}}(M_2) + \sigma u(M_2) = 0
    \Rightarrow u(M_2) = -\frac{1}{\sigma}\frac{\partial u}{\partial\bm{n}}(M_2)<0.\]
  故 $u(M_2)<u(M_1)$, 矛盾, 故假设不成立, 所以
  \[u\equiv C\Rightarrow\frac{\partial u}{\partial\bm{n}}\bigg|_{\varGamma} = 0
    \Rightarrow u|_{\varGamma}=0\Rightarrow u\equiv 0.\]
  
  对于第三边值问题的外问题: 记边界 $\varGamma$ 的外部为 $\varOmega'$,
  假设存在 $M_0\in\varOmega'$, 使得 $u(M_0)>0$, 由于 $\lim_{M\to\infty}u(M)=0$,
  故存在充分大的 $R$, 使得在 $\varGamma_R = \{r=R\}$ 上成立 $|u|<u(M_0)$,
  则由极值原理知 $u$ 的最大值只能在 $\varGamma$ 上取, 设最大值点为 $M_1\in\varGamma$, 则
  \[\frac{\partial u}{\partial\bm{n}}\bigg|_{M_1}+\sigma u(M_1)>0,\]
  与边界条件相矛盾, 假设 $u(M_0)<0$ 同样可以导出矛盾, 故$u\equiv 0$.
\end{proof}


\begin{exercise}
  说明在证明强极值原理过程中, 不可能作出一个满足条件 (1) 和 (3) 的辅助函数 $v(x,y,z)$,
  使它在整个球 $\closure{B}_R = \{x^2+y^2+z^2 \leq R^2\}$ 内满足 $\Delta v>0$.
\end{exercise}

\begin{proof}
  若在 $B_R$ 上有 $\Delta v>0$, 则
  \[\max_{\closure{B}_R} v = \max_{\partial B_R} v = 0.\]
  又因为 $\frac{\partial v}{\partial r} < 0$, 所以
  \[\min_{\closure{B}_R} v = \min_{\partial B_R} v = 0.\]
  结合二者即得 $v\equiv 0$, 与 $\Delta v>0$ 矛盾.
\end{proof}


\begin{exercise}
  设 $\varOmega$ 为 $\mathbb{R}^3$ 中有界区域, 边界为 $\varGamma$, $u$ 为定解问题
  \[\begin{cases}
    - \Delta u + cu = f, \\
    \biggl(\frac{\partial u}{\partial \bm{n}} + \sigma u\biggr)\biggm|_{\partial\varOmega} = g
  \end{cases}\]
  的解, 其中 $c,f,g,\sigma>0$, 证明在 $\closure{\varOmega}$ 上 $u>0$.
\end{exercise}


\begin{exercise}[6]
  对于一般的椭圆型方程
  \[\sum_{i,j=1}^n a_{ij}\frac{\partial^2u}{\partial x_i\partial x_j}
    + \sum_{i=1}^n b_i \frac{\partial u}{\partial x_i} + cu = 0,\]
  其中矩阵 $(a_{ij})$ 正定, 即存在常数 $\alpha>0$ 使得
  \[\sum_{i,j=1}^n a_{ij}\xi_i\xi_j \geq \alpha|\xi|^2\quad
    \forall\xi\in \mathbb{R}^n.\]
  又设 $c\leq 0$, 试证明它的解也成立着强极值原理.
  也就是说, 如果 $u(M)$ 在球 $|x|<R$ 内满足上述方程, 在闭球 $|x|\leq R$ 上连续,
  在球面上一点 $M_0$ 处取到非正的最小值, 且在该点沿 $\bm{\nu}$ 方向的方向导数
  $\frac{\partial u}{\partial \bm{\nu}}$ 存在, 其中 $\bm{\nu}$ 与球的内法线方向成锐角,
  则在 $M_0$ 点有 $\frac{\partial u}{\partial \bm{\nu}}>0$.
\end{exercise}

\begin{proof}
  若 $u$ 在球面上一点 $M_0$ 取非正的最小值, 即 $u(M_0)\leq 0$,
  且对球内任一点 $M$ 有 $u(M)>u(M_0)$, 因此在 $M_0$ 点有
  \[\frac{\partial u}{\partial\bm{\nu}}\geq 0.\]
  现在需要证明上式中的等号不能成立, 构造函数
  \[v(x) = \e^{-a\sum_{i=1}^nx_i^2} - \e^{-aR^2} = \e^{-a|x|^2} - \e^{-aR^2},\]
  其中 $a$ 为待定的正常数, 则 $v$ 满足如下性质:
  \begin{enumerate}[(1)]
    \item 在球面 $|x|=R$ 上 $v=0$;
    \item 通过适当选取 $a$, 在区域 $D=\{ R/2 \leq |x| \leq R\}$ 内
      \[Lv = \sum_{i,j=1}^na_{ij}\frac{\partial^2v}{\partial x_i\partial x_j}
        + \sum_{i=1}^nb_i\frac{\partial v}{\partial x_i}+cv > 0.\]
      事实上,因为
      \[\frac{\partial v}{\partial x_i} = -2a x_i \e^{-a|x|^2},\]
      \[\frac{\partial^2v}{\partial x_i\partial x_j} = 4a^2 x_i x_j 
        \e^{-a|x|^2},\quad i\neq j,\]
      \[\frac{\partial^2v}{\partial x_i^2} = 4a^2 x_i^2 \e^{-a|x|^2}
        -2a \e^{-a|x|^2}.\]
      所以
      \begin{align*}
      Lv
      & = 4a^2\left(\sum_{i,j=1}^na_{ij}x_ix_j\right) \e^{-a|x|^2}
        - 2a \sum_{i=1}^n (b_ix_i + a_{ii}) \e^{-a|x|^2} \\
      & \quad + c \left(\e^{-a|x|^2} - \e^{-aR^2}\right) \\
      & = \e^{-a|x|^2} \biggl\{ 4a^2\sum_{i,j=1}^n a_{ij} x_i x_j
        - 2a\sum_{i=1}^n (b_i x_i + a_{ii}) + c \left(1 - \e^{-a(R^2-|x|^2)}\right)\biggr\}
      \end{align*}
      因为 $\sum_{i,j=1}^n a_{ij} x_i x_j \geq \alpha |x|^2 \geq \frac{\alpha R^2}{4} > 0$,
      故当 $a$ 充分大时在区域 $D$ 内 $Lv > 0$.
    \item $v$ 沿球的半径方向$\frac{\partial v}{\partial r}<0$.
        于是 $\frac{\partial v}{\partial\bm{\nu}} > 0$.
  \end{enumerate}

  作函数
  \[\tilde{u}(M)=\varepsilon v(M)+u(M_0).\]
  在 $M_0$ 点有 $\frac{\partial\tilde{u}}{\partial\bm{\nu}}
  = \varepsilon\frac{\partial v}{\partial\bm{\nu}}>0$,
  令函数
  \[w(M) := u(M)-\tilde{u}(M) = u(M)-\varepsilon v(M)-u(M_0).\]
  
  在区域 $D$ 上考察 $w(M)$:
  \begin{enumerate}[(1)]
    \item $Lw=Lu-\varepsilon Lv-Lu(M_0)=-\varepsilon Lv-cu(M_0)<0$;
    \item 在 $|x| = R/2$ 上由于 $u(M)>u(M_0)$,
      取 $\varepsilon$ 足够小可使得 $w(M)>0$;
    \item 在 $|x| = R$ 上 $v=0$, $u(M)>u(M_0)$, 故 $w(M)\geq 0$.
  \end{enumerate}
  现在证明在整个区域 $D$ 上 $w\geq 0$, 假设存在 $M_1\in D$, 使得 $w(M_1) < 0$, 于是
  \[cw(M_1)\geq 0,\quad \frac{\partial w}{\partial x_i}\bigg|_{M_1} = 0,
    \quad\left(\frac{\partial^2w}{\partial x_i\partial x_j}\right)\bigg|_{M_1}\text{ 非负定}.\]
  又 $a_{ij}=\sum_{r=1}^n g_{ri}g_{rj}$, 故
  \[\sum_{i,j=1}^na_{ij}\frac{\partial^2w}{\partial x_i\partial x_j}
    \bigg|_{M_1}=\sum_{r=1}^n\sum_{i,j=1}^n\frac{\partial^2w}{\partial x_i\partial x_j}
    \bigg|_{M_1}g_{ri}g_{rj}\geq 0,\]
  因此 $Lw|_{M_1}\geq 0$, 与(1)矛盾, 因此在 $D$ 内 $w(M)\geq w(M_0)$, 故
  \[\frac{\partial w}{\partial\bm{\nu}}\bigg|_{M_0} \geq 0.\]
  从而
  \[\frac{\partial u}{\partial\bm{\nu}} > 0. \qedhere\]
\end{proof}