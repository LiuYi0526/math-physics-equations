\setcounter{chapter}{3}
\chapter{二阶线性偏微分方程的分类与总结}

\section{二阶线性方程的分类}


\begin{exercise}
  证明: 两个自变量的二阶线性方程经过自变量的可逆变换后, 其类型不会改变,
  即变换后 $\Delta = a_{12}^2 - a_{11}a_{22}$ 的符号不变.
\end{exercise}

\begin{proof}
  因为
  \[\begin{cases}
  \bar{a}_{11}=a_{11}\xi_x^2+2a_{12}\xi_x\xi_y+a_{22}\xi_y^2, \\
  \bar{a}_{12}=a_{11}\xi_x\eta_x+a_{12}(\xi_x\eta_y+\xi_y\eta_x)+a_{22}\xi_y\eta_y, \\
  \bar{a}_{22}=a_{11}\eta_x^2+2a_{12}\eta_x\eta_y+a_{22}\eta_y^2,
  \end{cases}\]
  所以
  \[\begin{split}
    \overline{\Delta}
    & = \bar{a}_{12}^2-\bar{a}_{11}\bar{a}_{22} \\
    & = a_{12}^2(\xi_x\eta_y+\xi_y\eta_x)^2-4a_{12}^2\xi_x\xi_y\eta_x\eta_y+2a_{11}a_{22}\xi_x\xi_y\eta_x\eta_y-a_{11}a_{22}(\xi_x^2\eta_y^2+\xi_y^2\eta_x^2) \\
    & = (a_{12}^2-a_{11}a_{22})(\xi_x\eta_y-\xi_y\eta_x)^2 \\
    & = \Delta\cdot\left[\frac{D(\xi,\eta)}{D(x,y)}\right]^2.
  \end{split}\]
  故 $\Delta$ 与 $\overline{\Delta}$ 的符号相同.
\end{proof}


\begin{exercise}
  判定下述方程的类型:
  \begin{enumerate}[(1)]
    \item $x^2u_{xx} - y^2u_{yy} = 0$;
    \item $u_{xx} + (x+y)^2 u_{yy} = 0$;
    \item $u_{xx} + xyu_{yy} = 0$;
    \item $u_{xx} - 4u_{xy} + 2u_{xz} + 4u_{yy} + u_{zz} = 0$;
    \item $u_{xx} + (\sgn y)u_{yy} = 0$.
  \end{enumerate}
\end{exercise}

\begin{solution}
  \begin{enumerate}[(1)]
    \item $\Delta = x^2y^2\geq 0$. Parabolic on the axes and hyperbolic in other places;
    \item $\Delta = -(x+y)^2\leq 0$. Parabolic on the line $x+y=0$ and elliptic elsewhere;
    \item $\Delta = -xy$. Elliptic in the 1st and 3rd quadrands, hyperbolic in the 2nd and 4th
      quadrands, and parabolic on the axes;
    \item The corresponding matrix is
      \[\begin{pmatrix}
        1 & -2 & 1 \\
        -2 & 4 & 0 \\
        1 & 0 & 1
      \end{pmatrix}.\]
      Since $D_1=1>0$, $D_2=0$ and $D_3=-4<0$, the type is hyperbolic;
    \item Since
      \[\Delta = -\sgn y \begin{cases}
        <0, & \text{if}\ y>0, \\
        =0, & \text{if}\ y=0, \\
        >0, & \text{if}\ y<0,
      \end{cases}\]
      the type is elliptic when $y>0$, hyperbolic when $y<0$ and parabolic when $y=0$.
  \end{enumerate}
\end{solution}


\begin{exercise}[3]
  化下列方程为标准形式:
  \begin{enumerate}[(1)]
    \item $u_{xx} + 4u_{xy} + 5u_{yy} + u_x + 2u_y = 0$;
    \item $x^2 u_{xx} + 2xy u_{xy} + y^2 u_{yy} = 0$;
    \item $u_{xx} + yu_{yy} = 0$;
    \item $u_{xx} - 2\cos x u_{xy} - (3 + \sin^2 x)u_{yy} - yu_y = 0$;
    \item $(1+x^2)u_{xx} + (1+y^2)u_{yy} + xu_x + yu_y = 0$.
  \end{enumerate}
\end{exercise}

\begin{solve}
  (1) $u_{xx}+4u_{xy}+5u_{yy}+u_x+2u_y=0$.
  $\Delta=4-5=-1<0$, 故方程为椭圆型.
  特征方程为 $\d y^2-4\d x\d y+5\d x^2=0\Rightarrow\frac{\d y}{\d x}=2\pm i\Rightarrow y=(2\pm i)x+C$, 取$y=(2+i)x+C$, 即$y-2x-ix=C$. 令
  \[\begin{cases}
  \xi=2x-y, \\
  \eta=x.
  \end{cases}\]
  则
  \[\begin{cases}
    u_x=2u_{\xi}+u_{\eta}, \\
    u_y=-u_{\xi}, \\
    u_{xx}=2(2u_{\xi\xi}+u_{\xi\eta})+2u_{\xi\eta}+u_{\eta\eta}=4u_{\xi\xi}+4u_{\xi\eta}+u_{\eta\eta}, \\
    u_{yy}=-(-u_{\xi\xi})=u_{\xi\xi}, \\
    u_{xy}=-(2u_{\xi\xi}+u_{\xi\eta}).
  \end{cases}\]
  代入原方程即得标准形式为
  \[u_{\xi\xi}+u_{\eta\eta}+u_{\eta} = 0.\]

  (2) $x^2u_{xx}+2xyu_{xy}+y^2u_{yy}=0$.
  $\Delta=x^2y^2-x^2y^2=0$, 故方程为抛物型.
  特征方程为 $x^2\d y^2-2xy\d x\d y+y^2\d x^2=0\Rightarrow y=Cx$. 令
  \[\begin{cases}
  \xi = \frac{y}{x}, \\
  \eta = x.
  \end{cases}\]
  则
  \[\begin{cases}
    u_x = -\frac{y}{x^2}u_{\xi}+u_{\eta}, \\
    u_y = \frac{1}{x}u_{\xi}, \\
    u_{xx} = \frac{2y}{x^3}u_{\xi}-\frac{y}{x^2}
      \left(-\frac{y}{x^2}u_{\xi\xi}+u_{\xi\eta}\right)-\frac{y}{x^2}u_{\eta\xi}+u_{\eta\eta}
      = \frac{2y}{x^3}u_{\xi}+\frac{y^2}{x^4}u_{\xi\xi}-\frac{2y}{x^2}u_{\xi\eta}+u_{\eta\eta}, \\
    u_{yy}=\frac{1}{x^2}u_{\xi\xi}, \\
    u_{xy}=-\frac{1}{x^2}u_{\xi}+\frac{1}{x}\left(-\frac{y}{x^2}u_{\xi\xi}+u_{\xi\eta}\right)
      = -\frac{1}{x^2}u_{\xi}-\frac{y}{x^3}u_{\xi\xi}+\frac{1}{x}u_{\xi\eta}.
  \end{cases}\]
  代入原方程即得标准形式为
  \[x^2u_{\eta\eta}=0\Rightarrow u_{\eta\eta} = 0.\]

  (3) $u_{xx}+yu_{yy}=0$.
  $\Delta=-y$, 故 $y>0$时为椭圆型, $y=0$时为抛物型, $y<0$ 时为双曲型.
  特征方程为 $\d y^2+y\d x^2=0$.

  (i) $y>0$ 时, $\frac{\d y}{\d x}=\pm\sqrt{y}i$,
  取 $\frac{\d y}{\d x}=\sqrt{y}i\Rightarrow 2\sqrt{y}-ix=C$,令
  \[\begin{cases}
  \xi = 2\sqrt{y}, \\
  \eta=-x.
  \end{cases}\]
  则
  \[\begin{cases}
    u_x = -u_{\eta}, \\
    u_{xx} = u_{\eta\eta}, \\
    u_{y} = \frac{1}{\sqrt{y}}u_{\xi}, \\
    u_{yy} = -\frac{1}{2}y^{-3/2}u_{\xi}+\frac{1}{y}u_{\xi\xi}.
  \end{cases}\]
  代入原方程即得标准形式为
  \[u_{\eta\eta}+u_{\xi\xi}-\frac{1}{\xi}u_{\xi} = 0.\]

  (ii) $y=0$ 时, $u_{xx}=0$即为标准形式.

  (iii) $y<0$ 时, $\frac{\d y}{\d x}=\pm\sqrt{-y}\Rightarrow 2\sqrt{-y}\pm x=C$,令
  \[\begin{cases}
  \xi = 2\sqrt{-y}+x, \\
  \eta = 2\sqrt{-y}-x.
  \end{cases}\]
  则
  \[\begin{cases}
    u_x=u_{\xi}-u_{\eta}, \\
    u_{xx}=u_{\xi\xi}-2u_{\xi\eta}+u_{\eta\eta}, \\
    u_{y}=\frac{-1}{\sqrt{-y}}(u_{\xi}+u_{\eta}), \\
    u_{yy}=-\frac{1}{2}(-y)^{-3/2}(u_{\xi}+u_{\eta})-\frac{1}{y}u_{\xi\xi}-\frac{1}{y}u_{\eta\eta}-\frac{2}{y}u_{\xi\eta}.
  \end{cases}\]
  代入原方程即得标准形式为
  \[u_{\xi\eta}-\frac{1}{2(\xi+\eta)}(u_{\xi}+u_{\eta}) = 0.\]

  (4) $u_{xx}-2\cos xu_{xy}-(3+\sin^2x)u_{yy}-yu_y=0$.
  $\Delta=\cos^2x+3+\sin^2x=4>0$, 故方程为双曲型.
  特征方程为 $\d y^2+2\cos x\d x\d y-(3+\sin^2x)\d x^2\Rightarrow\frac{\d y}{\d x}=-\cos x\pm2\Rightarrow y+\sin x\pm2x=C\Rightarrow y+\sin x\pm 2x=C$.
  令
  \[\begin{cases}
  \xi = y+\sin x+2x, \\
  \eta = y+\sin x-2x.
  \end{cases}\]
  则
  \[\begin{cases}
    u_x = (\cos x+2)u_{\xi}+(\cos x-2)u_{\eta}, \\
    u_y = u_{\xi}+u_{\eta}, \\
    u_{xx} = -\sin x(u_{\xi}+u_{\eta}) + (\cos x+2)^2u_{\xi\xi}+(\cos x-2)^2u_{\eta\eta}
      + 2(\cos^2x-4)u_{\xi\eta}\\
    u_{yy} = u_{\xi\xi}+2u_{\xi\eta}+u_{\eta\eta}, \\
    u_{xy} = (\cos x+2)u_{\xi\xi}+2\cos xu_{\xi\eta}+(\cos x-2)u_{\eta\eta}.
  \end{cases}\]
  代入原方程即得标准形式为
  \[u_{\xi\eta}+\frac{\xi+\eta}{32}(u_{\xi}+u_{\eta}) = 0.\]

  (5) $(1+x^2)u_{xx}+(1+y^2)u_{yy}+xu_x+yu_y=0$.
  $\Delta=-(1+x^2)(1+y^2)<0$,故方程为椭圆型.
  特征方程为$(1+x^2)\d y^2+(1+y^2)\d x^2=0\Rightarrow\frac{\d y}{\d x}=\pm\sqrt{\frac{1+y^2}{1+x^2}}i\Rightarrow\frac{\d y}{\sqrt{1+y^2}}=\pm i\frac{\d x}{\sqrt{1+x^2}}\Rightarrow\ln(y+\sqrt{1+y^2})\pm i\ln(x+\sqrt{1+x^2})=C$\\
  令
  \[\begin{cases}
  \xi = \ln(y+\sqrt{1+y^2}), \\
  \eta=\ln(x+\sqrt{1+x^2}).
  \end{cases}\]
  则
  \[\begin{cases}
    u_x = \frac{1}{\sqrt{1+x^2}}u_{\eta}, \\
    u_y = \frac{1}{\sqrt{1+y^2}}u_{\xi}, \\
    u_{xx} = -x(1+x^2)^{-3/2}u_{\eta}+\frac{1}{1+x^2}u_{\eta\eta}, \\
    u_{yy} = -y(1+y^2)^{-3/2}u_{\xi}+\frac{1}{1+y^2}u_{\xi\xi}.
  \end{cases}\]
  代入原方程即得标准形式为
  \[u_{\xi\xi}+u_{\eta\eta}=0. \qedhere\]
\end{solve}


\begin{exercise}
  证明: 两个自变量的二阶常系数双曲型方程或椭圆型方程一定可以经过自变量
  及未知函数的可逆变换
  \[u = \e^{\lambda\xi + \mu\eta} v\]
  将它化成
  \[v_{\xi\xi} \pm v_{\eta\eta} + cv = f\]
  的形式.
\end{exercise}

\begin{proof}
  已知两个自变量的二阶常系数双曲型方程或椭圆型方程可以通过可逆变换化为标准形式:
  \[u_{\xi\xi}\pm u_{\eta\eta}+au_{\xi}+bu_{\eta}+cu+f=0\]
  下面以椭圆型方程为例,因为$u=e^{\lambda\xi+\mu\eta}v$,所以
  \[\begin{cases}
  u_{\xi}=e^{\lambda\xi+\mu\eta}(\lambda v+v_{\xi})\\
  u_{\eta}=e^{\lambda\xi+\mu\eta}(\mu v+v_{\eta})\\
  u_{\xi\xi}=e^{\lambda\xi+\mu\eta}(v_{\xi\xi}+2\lambda v_{\xi}+\lambda^2v)\\
  u_{\eta\eta}=e^{\lambda\xi+\mu\eta}(v_{\eta\eta}+2\mu v_{\eta}+\mu^2v)
  \end{cases}\]
  故
  \[\begin{split}
  u_{\xi\xi}&+u_{\eta\eta}+au_{\xi}+bu_{\eta}+cu+f\\
  &=e^{\lambda\xi+\mu\eta}\big[v_{\xi\xi}+v_{\eta\eta}+(2\lambda+a)v_{\xi}+(2\mu+b)v_{\eta}+(\lambda^2+\mu^2+a\lambda+b\mu+c)v\big]+f\\
  &=0
  \end{split}\]
  令\[\lambda=-\frac{a}{2},\mu=-\frac{b}{2},c_1=c-\frac{a^2}{4}-\frac{b^2}{4},f_1=-fe^{-(\lambda\xi+\mu\eta)}\]
  即可将原方程化简为
  \[v_{\xi\xi}+v_{\eta\eta}+c_1v=f_1\]
  对于双曲型方程的情形可以进行类似证明.
\end{proof}


\begin{exercise}
  对 $\mathbb{R}^n$ 中诸点判定方程
  \[ \sum_{i,j=1}^n (\delta_{ij}-x_ix_j)\frac{\partial^2 u}{\partial x_i\partial x_j}
      + 2\sum_{i=1}^n x_i \frac{\partial u}{\partial x_i} + cu = f \]
  的类型.
\end{exercise}

\begin{solution}
  The corresponding matrix is
  \[ A = \begin{pmatrix}
          1-x_1^2 & -x_1x_2 & \cdots & -x_1x_n \\
          -x_2x_n & 1-x_2^2 & \cdots & -x_2x_n \\
          \vdots  & \vdots  & \ddots & \vdots  \\
          -x_1x_n & -x_2x_n & \cdots & -x_n^2
        \end{pmatrix}
       = E - xx^T,
  \]
  where $x = (x_1,\ldots,x_n)^T$. By \href{https://en.wikipedia.org/wiki/Matrix_determinant_lemma}{matrix determinant lemma}, we have for $\lambda\neq 1$,
  \begin{align*}
    |\lambda E-A|
    & = |(\lambda-1)E + xx^T| \\
    & = \biggl(1 + x^T\frac{E}{\lambda-1}x\biggr) \det \bigl((\lambda-1)E\bigr) \\
    & = (\lambda-1)^{n-1} (\lambda-1+x^Tx).
  \end{align*}
  Obviously the case $\lambda=1$ can also be incorporated into the above formula.
  Therefore we find that the eigenvalues of $A$ are $\lambda_1=1$
  (with multiplicity $n-1$ or $n$)
  and $\lambda_2 = 1-x^Tx$. So
  \begin{itemize}
    \item If $x^Tx = \sum x_i^2 =1$, the equation is parabolic;
    \item If $x^Tx = \sum x_i^2 <1$, the equation is elliptic;
    \item If $x^Tx = \sum x_i^2 >1$, the equation is hyperbolic. \qedhere
  \end{itemize}
\end{solution}


\section{二阶线性方程的特征理论}


\begin{exercise}
  求下列方程的特征方程和特征方向:
  \begin{enumerate}[(1)]
    \item $\displaystyle\frac{\partial^2 u}{\partial x_1^2} + \frac{\partial^2 u}{\partial x_2^2} = \frac{\partial^2 u}{\partial x_3^2} + \frac{\partial^2 u}{\partial x_4^2}$,
    \item $\displaystyle\frac{\partial^2 u}{\partial t^2} = \sum_{i=1}^3 \frac{\partial^2 u}{\partial x_i^2}$,
    \item $\displaystyle\frac{\partial u}{\partial t} = \frac{\partial^2 u}{\partial x^2} - \frac{\partial^2 u}{\partial y^2}$.
  \end{enumerate}
\end{exercise}


\begin{solve}
	(1)特征方程:
	$$\alpha_1^2+\alpha_2^2=\alpha_3^2+\alpha_4^2,$$
	由$\alpha_1^2+\alpha_2^2+\alpha_3^2+\alpha_4^2=1$,故可令
	$$\alpha_{1}=\frac{1}{\sqrt{2}}\cos\alpha,\alpha_{2}=\frac{1}{\sqrt{2}}\sin\alpha,\alpha_{3}=\frac{1}{\sqrt{2}}\cos\beta,\alpha_{4}=\frac{1}{\sqrt{2}}\sin\beta,$$
	得特征方向
	$$(\frac1{\sqrt{2}}\cos\alpha,\frac1{\sqrt{2}}\sin\alpha,\frac1{\sqrt{2}}\cos\beta,\frac1{\sqrt{2}}\sin\beta).$$
	
	(2)特征方程：
	$$\alpha_0^2=\alpha_1^2+\alpha_2^2+\alpha_3^2$$
	由$\alpha_1^2+\alpha_2^2+\alpha_3^2+\alpha_0^2=1$,解得$\alpha_0=\frac1{\sqrt{2}}$,	则特征方向为与 $t$ 轴夹角为$\frac\pi4$的任意方向.
	
	(3)特征方程：
	$$\alpha_1^2-\alpha_2^2=0.$$
	由$\alpha_1^2+\alpha_2^2+\alpha_0^2=1$, 解得特征方向
	\[(\cos\alpha,\frac1{\sqrt{2}}\sin\alpha,\pm\frac1{\sqrt{2}}\sin\alpha).\qedhere\]
\end{solve}


\begin{exercise}
  对波动方程 $u_{tt} - a^2(u_{xx}+u_{yy}) = 0$, 求过直线 $l: t = 0, y = 2x$ 的特征平面.
\end{exercise}

\begin{solve}
  The characteristic equation is
  \[\alpha_0^2-a^2(\alpha_1^1+\alpha_2^2) = 0.\]
  Combining $\alpha_0^2+\alpha_1^2+\alpha_2^2=1$, we find
  \[\alpha_0 = \pm\frac{a}{\sqrt{1+a^2}},
    \quad \alpha_1=\frac{\cos\theta}{\sqrt{1+a^2}},
    \quad \alpha_2=\frac{\sin\theta}{\sqrt{1+a^2}}.\]
  Since the characteristic hyperplane passes through the origin,
  we may write its equation as
  \begin{equation}\label{eq:4.6}
    at + \cos\theta\, x + \sin\theta\, y = 0.
  \end{equation}
  On the other hand, the line $t=0, y=2x$ is on the hyperplane \eqref{eq:4.6}.
  So $\cos\theta+2\sin\theta = 0$, from which we get
  $\cos\theta = \mp\frac{2\sqrt{5}}{5}$ and $\sin\theta = \pm\frac{\sqrt{5}}{5}$.
  Thus the hyperplane is
  \[ at \mp \frac{2\sqrt{5}}{5}x \pm \frac{\sqrt{5}}{5}y = 0. \qedhere \]
\end{solve}


\begin{exercise}
  证明: 经过可逆的坐标变换 $x_i = f_i(y_1, \ldots, y_n)$ $(i=1, \ldots, n)$,
  原方程的特征曲面变为经变换后的新方程的特征曲面,
  即特征曲面关于可逆坐标变换具有不变性.
\end{exercise}

\begin{proof}
  考虑二阶线性方程
  \begin{equation}\label{eq:4.7}
    \sum_{i,j=1}^nA_{ij}\frac{\partial^2u}{\partial x_i\partial x_j}
    + \sum_{i=1}^nB_i\frac{\partial u}{\partial x_i} + Cu = F.
  \end{equation}
  设 $G(x_1,\ldots,x_n)=0$ 为其特征曲面, 则
  \begin{equation}\label{eq:4.1}
    \sum_{i,j=1}^nA_{ij}\frac{\partial G}{\partial x_i}\frac{\partial G}{\partial x_j}=0.
  \end{equation}
  经过可逆的坐标变换 $x_i=f_i(y_1,\ldots,y_n)$, 有
  \[\frac{\partial u}{\partial x_i}
    = \sum_{l=1}^n\frac{\partial u}{\partial y_l}\frac{\partial y_l}{\partial x_i},\]
  \[\frac{\partial^2u}{\partial x_i\partial x_j}
    = \sum_{k,l=1}^n\frac{\partial^2u}{\partial y_l\partial y_k}\frac{\partial y_l}{\partial x_i}\frac{\partial y_k}{\partial x_j}
      + \sum_{l=1}^n\frac{\partial u}{\partial y_l}\frac{\partial^2y_l}{\partial x_i\partial x_j}.\]
  将上面两式代入原方程~\eqref{eq:4.7} 得
  \[ \sum_{i,j=1}^nA_{ij}\Biggl(\sum_{k,l=1}^n\frac{\partial^2u}{\partial y_l\partial y_k}\frac{\partial y_l}{\partial x_i}\frac{\partial y_k}{\partial x_j}
    + \sum_{l=1}^n\frac{\partial u}{\partial y_l}\frac{\partial^2y_l}{\partial x_i\partial x_j}\Biggr)
    + \sum_{i=1}^nB_i\Biggl(\sum_{l=1}^n\frac{\partial u}{\partial y_l}\frac{\partial y_l}{\partial x_i}\Biggr) + Cu = F. \]
  整理上式并简记一阶偏导数项得
  \[ \sum_{k,l=1}^n\Biggl(\sum_{i,j=1}^nA_{ij}\frac{\partial y_l}{\partial x_i}\frac{\partial y_k}{\partial x_j}\Biggr)\frac{\partial^2u}{\partial y_l\partial y_k}
    + \sum_{l=1}^n\widetilde{B}_l\frac{\partial u}{\partial y_l} + Cu = F. \]
  设 $G^*(y_1,\ldots,y_n)$ 为其特征曲面, 则需满足
  \[ \sum_{k,l=1}^n\Biggl(\sum_{i,j=1}^nA_{ij}\frac{\partial y_l}{\partial x_i}\frac{\partial y_k}{\partial x_j}\Biggr)\frac{\partial G^*}{\partial y_k}\frac{\partial G^*}{\partial y_l} = 0. \]
  另一方面, 对原方程的特征曲面经过可逆变换后的特征曲面为:
  \[ G(x_1,\ldots,x_n) = G(f_1(y_1,\ldots,y_n),\ldots,f_n(y_1,\ldots,y_n)) =: G_1(y_1,\ldots,y_n), \]
  由 \eqref{eq:4.1} 得
  \[ \sum_{i,j=1}^nA_{ij}\Biggl(\sum_{l=1}^n\frac{\partial G_1}{\partial y_l}\frac{\partial y_l}{\partial x_i}\Biggr)\Biggl(\sum_{k=1}^n\frac{\partial G_1}{\partial y_k}\frac{\partial y_k}{\partial x_j}\Biggr)
    = \sum_{k,l=1}^n\Biggl(\sum_{i,j=1}^nA_{ij}\frac{\partial y_l}{\partial x_i}\frac{\partial y_k}{\partial x_j}\Biggr)\frac{\partial G_1}{\partial y_k}\frac{\partial G_1}{\partial y_l}=0. \]
  对比即得$G^*=G_1$,即特征曲面关于可逆坐标变换具有不变性.
\end{proof}


\begin{exercise}
  试证二阶线性偏微分方程解的 $m$ 阶弱间断 (即直至 $m-1$ 阶的偏导数为连续, 而 $m$ 阶偏导数为第一类间断)
  也只可能沿着特征线发生.
\end{exercise}

\begin{proof}
  Similar to the proof in the textbook. For its proof,
  see \cite[\S2.1.2]{chen_2018}.
\end{proof}


\begin{exercise}
  试定义 $n$ 阶线性偏微分方程的特征方程、特征方向和特征曲面.
\end{exercise}

\begin{solution}
  See \cite[\S2.1.2]{chen_2018}.
  For $n$-th order linear partial differential equation
  \begin{equation}\label{eq:4.2}
    \sum_{|\alpha|\leq n} a_\alpha(x) D^\alpha u(x) = 0,
  \end{equation}
  where $\alpha=(\alpha_1,\ldots,\alpha_n)$ is a multi-index
  and $D^\alpha u(x) = \frac{\partial^{|\alpha|} u}{\partial x_1^{\alpha_1}\cdots\partial x_n^{\alpha_n}}$,
  $|\alpha| = \sum \alpha_i$. We say that the surface
  \begin{equation}\label{eq:4.3}
    S: \varphi(x) = 0
  \end{equation}
  is the characteristic surface of \eqref{eq:4.2} if
  \begin{equation}\label{eq:4.4}
    \sum_{|\alpha|=n} a_\alpha(x) (\nabla\varphi(x))^\alpha
      = \sum_{|\alpha|=n} a_\alpha(x) \prod_{i=1}^n
        \biggl(\frac{\partial\varphi}{\partial x_i}\biggr)^{\alpha_i} = 0.
  \end{equation}
  And a vector $v = (v_1,\ldots,v_n)$ is called the characteristic vector
  if it satisfies the following characteristic equation
  \begin{equation}\label{eq:4.5}
    \sum_{|\alpha|=n} a_\alpha(x) v^\alpha
      = \sum_{|\alpha|=n} a_\alpha(x) v_1^{\alpha_1} \cdots v_n^{\alpha_n} = 0.
  \end{equation}
\end{solution}


\begin{exercise}[7]
	说明方程 $u_{xy} + u_{yz} + u_{xz} = 0$ 是双曲型方程, 并求出它过原点的特征锥面.
\end{exercise}

\begin{solve}
	考虑
	$$A=\begin{vmatrix}
		0&\frac{1}{2}&\frac{1}{2}\\
		\frac{1}{2}&0&\frac{1}{2}\\
		\frac{1}{2}&\frac{1}{2}&0
	\end{vmatrix}.$$
	其特征值为
	$$\lambda_1=1,\lambda_2=-\frac{1}{2}\text{(二重)}.$$
	特征方向$(\alpha_1,\alpha_2,\alpha_3)$满足
	$$\begin{cases}
		\alpha_1\alpha_2+\alpha_2\alpha_3+\alpha_3\alpha_1=0\\
		\alpha_1^2+\alpha_2^2+\alpha_3^2=1,
	\end{cases}$$
	解得特征方向只有三种$(1,0,0),(0,1,0),(0,0,1)$. 则过原点与$x=0,y=0,z=0$相切的锥面方程为
	\[x^2+y^2+z^2=\frac{(x+y+z)^2}2.\qedhere\]
\end{solve}
\section{先验估计}

\begin{exercise}[2]
  设 $u(x_1,\ldots,x_n)$ 在区域 $\Omega$ 上非负, 且满足不等式
  \[Lu = \sum_{i,j=1}^n a_{ij}(x) u_{x_ix_j} + \sum_{i=1}^n b_i(x) u_{x_i} + c(x)u\geq 0,\]
  其中 $a_{ij}$, $b_i$, $c$ 在 $\overline{\Omega}$ 上具有一阶连续偏导数,
  满足 (4.38) 式, 且 $c(x)\leq 0$,
  证明极值原理 $\max_{\overline{\Omega}}u=\max_{\Gamma}u$ 成立.
\end{exercise}

\begin{proof}
  See \cite[Lemma~2.1 \& Theorem~2.3]{han_elliptic_2011}.

  Firstly, we suppose that $Lu >0$ in $\Omega$ and $u$ attains its nonnegative
  maximum at $x_0\in\Omega$. Then $Du(x_0) = 0$ and $B = D^2u(x_0)$
  is seminegative definite. By the ellipticity condition
  the matrix $A = (a_{ij}(x_0))$ is positive definite.
  Hence the matrix $AB$ is seminegative definite with a nonpositive trace,
  that is, $\sum a_{ij}(x_0) D_{ij}u(x_0)\leq 0$. This implies $Lu(x_0)\leq 0$,
  which is a contradiction.

  Then we consider the general case $Lu\geq 0$.
  For any $\varepsilon>0$, let $w(x) = u(x) + \varepsilon e^{\lambda x_1}$ with $\lambda$
  to be determined. Then
  \[ Lw = Lu + \varepsilon e^{\lambda x_1} \bigl(a_{11}\lambda^2
      + b_1\lambda +c\bigr). \]
  Since $b_1$ and $c$ are bounded and $a_{11}(x)\geq\alpha>0$
  for any $x\in\Omega$, by choosing $\lambda>0$ large enough
  we get
  \[ a_{11}(x)\lambda^2 + b_1(x)\lambda + c(x) >0 \quad \text{for any}\ x\in\Omega.\]
  This implies $Lw>0$ in $\Omega$. By the first case we know that
  $w$ attains its nonnegative maximum only at $\partial\Omega$, i.e.,
  \[ \sup_{\Omega} w \leq \sup_{\partial\Omega} w. \]
  Thus
  \[ \sup_{\Omega} u \leq \sup_{\Omega} w
      \leq \sup_{\partial\Omega} u
        + \varepsilon \sup_{x\in\partial\Omega} e^{\alpha x_1}. \]
  We finish the proof by letting $\varepsilon\to 0$.
\end{proof}


\begin{exercise}
  设 $u\in C^2(\Omega)\cap C(\overline{\Omega})$ 是椭圆型方程 Dirichlet 问题
  \[\begin{cases}
    Lu = \sum_{i,j=1}^n a_{ij}(x) u_{x_ix_j} + \sum_{i=1}^n b_i(x) u_{x_i} + c(x)u = f(x), \\
    u|_{\varGamma} = \varphi(x)
  \end{cases}\]
  的解, 系数 $a_{ij}$, $b_i$, $c$ 满足第一题中的条件, 则成立最大模估计式 (4.4).
\end{exercise}

\begin{proof}
  See \cite[Proposition 2.15]{han_elliptic_2011}.
  We will construct a function $w$ in $\Omega$ such that
  \begin{alignat}{2}
    L(w\pm u) & = Lw \pm f \leq 0 &\quad& \text{in } \Omega, \label{eq:4.8} \\
    w\pm u    & = w \pm \varphi \geq 0 && \text{on } \partial\Omega. \label{eq:4.9}
  \end{alignat}
  Denote $F = \max_\Omega |f|$ and $\Phi = \max_{\partial\Omega} |\varphi|$.
  To make~\eqref{eq:4.8} and \eqref{eq:4.9} hold, it suffices to require that
  \[\begin{cases}
    Lw \leq -F, & \text{in}\ \Omega, \\
    w\geq \Phi, & \text{on}\ \partial\Omega.
  \end{cases}\]
  Suppose the domain $\Omega$ lies in the set $\{0<x_1<d\}$ for some $d>0$.
  Set $w = \Phi + (e^{\lambda d} - e^{\lambda x_1})F$ with $\lambda>0$
  to be determined later. Then we have
  \begin{align*}
    Lw
    & = -a_{11}\lambda^2 e^{\lambda x_1} F - b_1 \lambda e^{\lambda x_1} F
        + c\Phi + c(e^{\lambda d} - e^{\lambda x_1}) F \\
    & \leq -(a_{11}\lambda^2 + b_1 \lambda) e^{\lambda x_1} F \\
    & \leq -(\alpha\lambda^2 + b_1 \lambda) e^{\lambda x_1} F \leq -F
  \end{align*}
  by choosing $\lambda$ large enough such that $\alpha\lambda^2 + b_1\lambda\geq 1$
  for any $x\in\Omega$. Hence $w$ satisfies~\eqref{eq:4.8}
  and~\eqref{eq:4.9}. By maximum principle obtained in the last exercise,
  we conclude that $-w\leq u\leq w$ in $\Omega$. In particular,
  \[ \sup_\Omega |u| \leq \Phi + (e^{\lambda d}-1)F. \qedhere\]
\end{proof}


\begin{exercise}
  在 $Q_T = (0,l)\times (0,T)$ 中考察下列初边值问题
  \begin{align}
    & u_{tt} - a^2 u_{xx} + b(x,t)u_x + b_0(x,t)u_t + c(x,t)u = f(x,t), \tag{$\star$} \\
    & u|_{x=0} = 0,\qquad (u_x + ku)|_{x=l} = 0, \notag \\
    & u|_{t=0} = \varphi(x), \qquad u_t|_{t=0} = \psi(x), \notag
  \end{align}
  证明其解的唯一性及稳定性.
\end{exercise}

\begin{proof}
  We suppose $k\geq 0$. Define the energy functional
  \[ E(t) := \frac12 \int_0^l (u_t^2 + a^2 u_x^2) \d x + \frac12 ka^2 u^2(l,t). \]
  Multiplying both sides of the equation $(\star)$ by $u_t$ and integrating
  from $0$ to $l$ with respect to $x$, we get
  \begin{align*}
    \frac{\d E(t)}{\d t}
    & = - \int_0^l (bu_xu_t + b_0 u_t^2 + cuu_t) \d x
        + \int_0^l fu_t \d x \\
    & \leq C\int_0^l (u_t^2 + u_x^2 + f^2) \d x \\
    & \leq C\biggl(E(t) + \int_0^l f^2 \d x\biggr),
  \end{align*}
  from which it follows that
  \[ E(t) \leq E(0)e^{Ct} + C\int_0^t e^{C(t-s)} \int_0^l f^2 \d x\d s. \]
\end{proof}


\begin{exercise}
  建立下列初边值问题的能量估计式:
  \[u_t - \Delta u + \sum_{i=1}^n b_i(x,t) u_{x_i} + c(x,t)u = f(x,t),\]
  \[\frac{\partial u}{\partial n}\bigg|_{\varGamma} = 0,
    \qquad u|_{t=0} = \varphi(x).\]
\end{exercise}

\begin{proof}
  Choose any $T>0$ and we establish the energy estimates in $[0,T]$.
  Let $E(t) = \int_{\Omega} u^2(x,t) \d x$. Then
  \begin{align*}
    E'(t)
    & = 2\int_{\Omega} uu_t \d x \\
    & = 2\int_{\Omega}u\Delta u\d x
        - 2\sum_{i=1}^n\int_{\Omega}b_iuu_{x_i}\d x
        - 2\int_{\Omega}cu^2\d x+2\int_{\Omega}uf\d x.
  \end{align*}
  By Green's formula we have
  \[ \int_{\Omega} u\Delta u \d x = -\int_{\Omega}|\nabla u|^2\d x. \]
  Let $M$ be an upper bound of $|b(x,t)|$ and $|c(x,t)|$
  in $\overline{\Omega}\times [0,T]$. Then we have
  \begin{align*}
    E'(t)
    & \leq -2\int_{\Omega}|\nabla u|^2\d x
      + 2M \sum_{i=1}^n\int_{\Omega}|uu_{x_i}|\d x
      + 2M \int_{\Omega}u^2\d x+2\int_{\Omega}|uf|\d x \\
    & \leq -2\int_{\Omega}|\nabla u|^2\d x
        + M \left(\epsilon\int_{\Omega}|\nabla u|^2\d x
        + \frac{n}{\epsilon}\int_{\Omega}u^2\d x\right) \\
    & \qquad\qquad + (2M+1)\int_{\Omega}u^2\d x+\int_{\Omega}f^2\d x.
  \end{align*}
  Take $\epsilon = \frac{2}{M}$ and let $C = nM^2/2 + 2M + 1$ to have
  \[ E'(t) \leq CE(t) + \int_{\Omega} f^2 \d x. \]
  By Gronwall's inequality, it follows that
  \[ E(t) \leq e^{Ct}E(0) + \int_0^t e^{C(t-s)} \int_{\Omega} f^2 \d x\d s\]
  for all $0\leq t\leq T$.
\end{proof}


\begin{exercise}
	设$c(x)<0$,证明椭圆型方程第一边值问题(4.37),(4.39)的解的唯一性.
\end{exercise}

\begin{proof}
	椭圆型方程第一边值问题
	$$\begin{cases}
		\sum\limits_{i,j=1}^na_{ij}(x)u_{x_ix_j}+\sum\limits_{i=1}^nb_i(x)u_{x_i}+c(x)u=f(x),&\quad x\in\Omega,\\
		u|_{\partial\Omega}=0,
	\end{cases}$$
	其中$c(x)\leq0$.
	
	由第1题结论, 该问题对应的齐次问题满足极值原理,即最大、最小值只能在边界上达到.于是,齐次问题仅有零解,可得非齐次问题解的唯一性.
\end{proof}


\begin{exercise}
  考察边值问题
  \begin{align*}
    & \Delta u + \sum_{i=1}^{n} b_i(x) u_{x_i} + c(x)u = f, \\
    & \frac{\partial u}{\partial n}\bigg|_{\varGamma} = 0.
  \end{align*}
  试证当 $c(x)$ 充分负时, 其解在能量模意义下的稳定性.
\end{exercise}

\begin{proof}
  The proof is actually the same as that of Theorem~4.6 in the textbook.
\end{proof}


\section{三类方程的比较}


\begin{exercise}
	试回顾用前学过的求解偏微分方程定解问题的各种方法,并指出叠加原理在哪里被用到.
\end{exercise}

\begin{solve}
	\begin{enumerate}[(1)]
		\item 将非齐次方程定解问题化为一个齐次方程定解问题和一个非齐次方程且有零初始条件的问题,利用了线性方程叠加原理;
		\item 齐次化原理也利用了叠加原理;
		\item 分离变量法中利用了叠加原理;
		\item 行波法解一维波动方程;
		\item 平均值法解三维波动方程柯西问题;
		\item 降维法解三维波动方程柯西问题;
		\item 傅立叶变换法;
		\item 格林函数解拉普拉斯方程的边值问题.
	\end{enumerate}
\end{solve}


\begin{exercise}
	证明热传导方程
	\[\frac{\partial u}{\partial t} = a^2 \frac{\partial^2 u}{\partial x^2}\]
	的初边值问题
	\[\begin{cases}
		u(0, t) = u(l, t) = 0, \\
		u(x, 0) = \varphi(x)
	\end{cases}\]
	的解关于自变量 $x$ ($0<x<l$) 和 $t$ ($t>0$) 可进行任意次微分.
\end{exercise}

\begin{proof}
	利用分离变量法得该初边值问题的解为
	\[u(x,t) = \sum_{n=1}^{\infty}C_ne^{-\frac{n^2\pi^2a^2}{l^2}t}\sin\frac{n\pi}{l}x,\]
	其中 $\displaystyle C_n=\frac{2}{l}\int_0^l\varphi(x)\sin\frac{n\pi}{l}x\d x$,
	$|C_n|\leq M$, 只需要证明级数逐项微分任意次后仍然是绝对且一致收敛即可,
	对 $t$ 微分 $\alpha$ 次, 对 $x$ 微分 $\beta$ 次需要级数
	\[\sum_{n=1}^{\infty}C_n\left(-\frac{n^2\pi^2a^2}{l^2}\right)^{\alpha}\left(\frac{n\pi}{l}\right)^{\beta}\left(\sin\frac{n\pi}{l}x\right)^{(\beta)}e^{-\frac{n^2\pi^2a^2}{l^2}t}\]
	绝对且一致收敛,而当$t\geq t_0>0$时,上述级数以
	\[\sum_{n=1}^{\infty}M\left(\frac{n\pi a}{l}\right)^{2\alpha}\left(\frac{n\pi}{l}\right)^{\beta}e^{-\frac{n^2\pi^2a^2}{l^2}t_0}\]
	为优级数,易知此级数收敛,故原级数绝对且一致收敛.
\end{proof}


\begin{exercise}
	举例说明弦振动方程不成立极值原理.
\end{exercise}

\begin{solution}
	函数$u(x,y)=\sin at\sin x$满足
	$$\begin{cases}
		u_{tt}=a^2u_{xx},&0<x<\pi,\quad t>0,\\
		u|_{x=0}=u|_{x=\pi}=0,&t>0,\\u|_{t=0}=0,u_t|_{t=0}=a\sin x,&0<x<\pi.
	\end{cases}$$
	它在初值$t=0$与边界$x=0, x=\pi$上为零, 内部不为零, 因此与热传导方程初边值问题类似的极值原理不存在.
	
	对一维 Cauchy 问题
	$$\left.\left\{\begin{array}{ll}u_{tt}=a^2u_{xx},&x\in\mathbb{R},\quad t>0,\\u|_{t=0}=0,&u_t|_{t=0}=\e^x,\end{array}\right.\right.$$
	解为
	$$u(x,t)=\frac1{2a}\int_{x-at}^{x+at}\e^\xi d\xi=\frac1{2a}\left(\e^{x+at}-\e^{x-at}\right)=\frac{\e^x}a\sinh at>0,$$
	但在初值$t=0$, $u$为零, 因而极值原理不成立.
\end{solution}