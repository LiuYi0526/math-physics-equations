\chapter{波动方程}

\section{方程的导出, 定解条件}


\begin{exercise}
  细杆或弹簧受某种外界原因而产生纵向振动, 
  以 $u(x,t)$ 表示静止时在 $x$ 点处的点在时刻 $t$ 离开原来位置的偏移.
  假设振动过程中所发生的张力服从胡克定律, 试证明 $u(x,t)$ 满足方程:
  \[\frac{\partial}{\partial t}\left(\rho(x)\frac{\partial u}{\partial t}\right)
    = \frac{\partial}{\partial x}\left(E\frac{\partial u}{\partial x}\right),\]
  其中 $\rho$ 为杆的密度, $E$为杨氏模量%
  \footnote{杨氏模量$E=\frac{F/S}{\Delta L/L}$衡量的是一个各向同性弹性体的刚度(stiffness),
    定义为在胡克定律适用的范围内,单轴应力和单轴形变之间的比.}.
\end{exercise}

\begin{proof}
  记杆的横截面积为 $S$,取杆的左端截面的形心为原点, 杆轴为 $x$ 轴,
  任取静止时坐标为 $(x,x+\Delta x)$ 的一小段细 杆$B$.
  在 $t$ 时刻, $B$ 的两段位移分别为 $u(x,t)$ 和 $u(x+\Delta x,t)$,
  $B$ 的伸长为 $\Delta L=u(x+\Delta x,t)-u(x,t)$, 故 $B$ 的应变为
  \[\frac{u(x+\Delta x,t)-u(x,t)}{\Delta x}.\]
  令 $\Delta x\to 0$ 即得 $x$ 点在时刻 $t$ 的应变为 $\displaystyle\frac{\partial u}{\partial x}(x,t)$,
  因此 $B$ 两端的张力分别为 $\displaystyle ES\frac{\partial u}{\partial x}(x,t)$
  和 $\displaystyle ES\frac{\partial u}{\partial x}(x+\Delta x,t)$, 故 $B$ 的运动方程为
  \[ES\frac{\partial u}{\partial x}(x+\Delta x,t)-ES\frac{\partial u}{\partial x}(x,t)
    = S\rho(x)\Delta x\frac{\partial^2u}{\partial t^2}(\bar{x},t).\]
  消去 $S$ 并令 $\Delta x\to 0$ 即得所证.
\end{proof}


\begin{exercise}
  在杆纵向振动时, 假设 (1)端点固定, (2)端点自由, (3)端点固定在弹性支承上,
  试分别导出这三种情况下所对应的边界条件.
\end{exercise}

\begin{solve}
	(1)杆的两端被固定在$x=0, x=l$两点则相应的边界条件为
	$$u(0,t)=0,\quad u(l,t)=0.$$
	
	(2)若$x=l$为自由端, 则杆在$x=l$的张力为
	$$T(l,t)=\left.\left(E(x)\frac{\partial u}{\partial x}\right)\right|_{x=l}=0.$$
	同理, 若$x=0$为自由端, 则相应的边界条件为
	$$\left.\frac{\partial u}{\partial x}\right|_{x=0}=0.$$
	
	(3)若$x=l$端点固定在弹性支承上, 而弹性支承固定于某点, 且该点离开原来位置的偏移由函数$v(t)$给出, 则在$x=l$端支承的伸长为$u(l,t)-v(t)$. 由Hooke定律有
	$$\left.\left(E(x)\frac{\partial u}{\partial x}\right)\right|_{x=l}=-k[u(l,t)-v(t)],$$
	其中$k$为支承的刚度系数, 由此得边界条件
	$$\left.\left(\frac{\partial u}{\partial x}+\sigma u\right)\right|_{x=l}=f(t),\quad\sigma=\frac{k}{E},\quad f(t)=\frac{kv(t)}{E(l)}.$$
	特别的, 若支承固定于一定点上, 则$v(t)=0$, 得边界条件为
	$$\left.\left(\frac{\partial u}{\partial x}+\sigma u\right)\right|_{x=0}=0.$$
	同理, 若$x=0$端固定在弹性支承上, 则得边界条件
	$$\left.\left(E(x)\frac{\partial u}{\partial x}\right)\right|_{x=0}=-k[u(0,t)-v(t)],$$
	即
	\[\left.\left(\frac{\partial u}{\partial x}+\sigma u\right)\right|_{x=0}=f(t).\qedhere\]
\end{solve}


\begin{exercise}
  试证:圆锥形枢轴的纵振动方程为
  \[E\frac{\partial}{\partial x}\left[\left(1-\frac{x}{h}\right)^2\frac{\partial u}{\partial x}\right]=\rho\left(1-\frac{x}{h}\right)^2\frac{\partial^2u}{\partial t^2},\]
  其中$h$为圆锥的高.
\end{exercise}

\begin{proof}
	不妨设枢纽底面的半径为$1$, 则$x$点处截面的半径$\displaystyle r=1-\frac xh$.所以截面积$\displaystyle S(x)=\pi r^2=\pi\left(1-\frac{x}{h}\right)^2$.利用第1题, 得
	$$\rho(x)\pi\left(1-\frac{x}{h}\right)^2\frac{\partial^2u}{\partial t^2}=\frac{\partial}{\partial x}\left[E\pi\left(1-\frac{x}{h}\right)^2\frac{\partial u}{\partial x}\right].$$
	若$E(x)=E$为常量, 则得
	\[E\dfrac{\partial}{\partial x}\left[\left(1-\dfrac{x}{h}\right)^2\dfrac{\partial u}{\partial x}\right]=\rho\left(1-\dfrac{x}{h}\right)^2\dfrac{\partial^2u}{\partial t^2}.\qedhere\]
\end{proof}


\begin{exercise}[6]
  绝对柔软而均匀的弦线有一端固定,在它本身重力的作用下,此线处于铅锤的平衡位置,试导出此线的微小横振动方程.
\end{exercise}

\begin{solve}
	设弦线长为$l$,线密度为$\rho$,则$x$点处的张力为
	$$T(x)=\rho g(l-x),$$
	且$T(x)$的方向总是沿着弦在$x$点处的切线方向.仍以$u(x,t)$表示弦上各点在时刻$t$沿垂直于$x$轴方向的位移,取弦段$(x,x+\Delta x)$,则弦段两端张力在$u$轴方向的投影分别为
	\[\rho g(l-x)\sin\theta(x),\quad\rho g(l-(x+\Delta x))\sin\theta(x+\Delta x),\]
	其中$\theta(x)$表示$T(x)$方向与$x$轴的夹角,又
	\[\sin\theta\approx\tan\theta=\frac{\partial u}{\partial x}.\]
	于是,得运动方程
	\[\rho\Delta x\dfrac{\partial^2u}{\partial t^2}=\left.(l-(x+\Delta x))\dfrac{\partial u}{\partial x}\right|_{x+\Delta x}\rho g-(l-x)\left.\dfrac{\partial u}{\partial x}\right|_x\rho g.\]
	利用微分中值定理,令$\Delta x\to0$得
	\[\dfrac{\partial^2u}{\partial t^2}=g\dfrac{\partial}{\partial x}\left[(l-x)\dfrac{\partial u}{\partial x}\right].\qedhere\]
\end{solve}


\begin{exercise}
  一柔软均匀的细弦, 一端固定, 另一段是弹性支承.
  设该弦在阻力与速度成正比的介质中作微小的横振动, 试写出弦的位移所满足的定解问题.
\end{exercise}

\begin{solve}
  由教材推导过程知此时满足:
  \[\int_t^{t+\Delta t}\int_x^{x+\Delta x}\left(T\frac{\partial^2u(x,t)}{\partial x^2}\
    - \rho\frac{\partial^2u(x,t)}{\partial t^2}
    - b\frac{\partial u(x,t)}{\partial t}\right)\diff x\diff t = 0.\]
  因此定解问题为(不妨设弹性支承在右端):
  \[\begin{cases}
    \displaystyle\frac{\partial^2u}{\partial t^2}
    - a^2\frac{\partial^2u}{\partial x^2}
    + \frac{b}{\rho}\frac{\partial u}{\partial t}
    = 0, \\
    \displaystyle u(x,0) = \varphi(x),\frac{\partial u(x,0)}{\partial t} = \psi(x),\\
    \displaystyle u|_{x=0}=0,\left(\frac{\partial u}{\partial x}
    + \sigma u\right)\bigg|_{x=l}=0.
  \end{cases}\qedhere\]
\end{solve}


\begin{exercise}
  若 $F(\xi)$, $G(\xi)$ 均为其变元的二次连续可导函数,
  验证 $F(x-at)$, $G(x+at)$ 均满足弦振动方程 (1.11).
\end{exercise}

\begin{proof}
  直接验证即可.
\end{proof}


\begin{exercise}
  验证
  \[u(x,y,t) = \frac{1}{\sqrt[]{t^2-x^2-y^2}}\]
  在锥 $t^2-x^2-y^2>0$ 中满足波动方程
  \[\frac{\partial^2 u}{\partial t^2}
    = \frac{\partial^2 u}{\partial x^2}
      + \frac{\partial^2 u}{\partial y^2}.\]
\end{exercise}

\begin{proof}
  直接计算
  \[\frac{\partial u}{\partial t}=-t(t^2-x^2-y^2)^{-\frac32},\quad
    \frac{\partial^2u}{\partial t^2}=(t^2-x^2-y^2)^{-\frac52}(2t^2+x^2+y^2),\]
  \[\frac{\partial u}{\partial x}=x(t^2-x^2-y^2)^{-\frac32},\quad
    \frac{\partial^2u}{\partial x^2}=(t^2-x^2-y^2)^{-\frac52}(t^2-2x^2+y^2).\]
  同理
  \[\frac{\partial u^2}{\partial y^2}=(t^2-x^2-y^2)^{-\frac52}(t^2+2y^2-x^2).\]
  结合以上三式可得
  \[\frac{\partial^2u}{\partial t^2}
    = \frac{\partial^2u}{\partial x^2}+\frac{\partial^2u}{\partial y^2}.\qedhere\]
\end{proof}


\section{达朗贝尔公式、波的传播}

\begin{exercise}
  证明方程
  \[\frac{\partial}{\partial x}\biggl[\biggl(1-\frac{x}{h}\biggr)^2
    \frac{\partial u}{\partial x}\biggr]
    = \frac{1}{a^2}\biggl(1-\frac{x}{h}\biggr)^2 \frac{\partial^2u}{\partial t^2}\quad(h>0,\text{常数})\]
  的通解可以写成
  \[u = \frac{F(x-at)+G(x+at)}{h-x},\]
  其中 $F$, $G$ 为任意的具有二阶连续导数的单变量函数, 并由此求它满足初始条件
  \[t=0: u = \varphi(x), \frac{\partial u}{\partial t} = \psi(x)\]
  的初值问题的解.
\end{exercise}

\begin{solve}
  原方程等价于
  \[\frac{\partial^2}{\partial x^2}[(h-x)u]
    = \frac{1}{a^2}\frac{\partial^2}{\partial t^2}[(h-x)u].\]
  故存在函数 $F$, $G$ 使得
  \[(h-x)u = F(x-at) + G(x+at),\]
  也即
  \[u = \frac{F(x-at)+G(x+at)}{h-x}.\]
  初值问题的解为
  \begin{align*}
    u(x,t)
     = \frac{1}{h-x}\biggl[
      & \frac12 (h-x+at)\varphi(x-at) + \frac12 (h-x-at)\varphi(x+at) \\
      & + \frac{1}{2a}\int_{x-at}^{x+at} (h-\xi)\psi(\xi)\diff\xi\biggr]. \qedhere
  \end{align*}
\end{solve}


\begin{exercise}
  问初始条件 $\varphi(x)$ 与 $\psi(x)$ 满足怎样的条件时,
  齐次波动方程初值问题的解仅由右传播波组成?
\end{exercise}

\begin{solution}
  If the solution to the homogeneous IVP only consists of right propagation
  waves, then
  \[ G(x) = \frac12\varphi(x) + \frac{1}{2a}\int_{x_0}^x \psi(\alpha) \d\alpha
    - \frac{C}{2\alpha} \]
  is a constant, which is equivalent to $\varphi'(x) + \frac1a \psi(x) = 0$.
\end{solution}


\begin{exercise}[3]
  利用传播波法, 求解波动方程的古尔萨 (Goursat) 问题
  \[\begin{cases}
    \displaystyle\frac{\partial^2u}{\partial t^2} = a^2 \frac{\partial^2u}{\partial x^2}\quad(-at<x<at,t>0),\\
    u|_{x-at=0} = \varphi(x)\quad(t>0),\\
    u|_{x+at=0} = \psi(x)\quad(t>0),\; \varphi(0) = \psi(0).
  \end{cases}\]
\end{exercise}

\begin{solve}
  设 $u(x,t)$ 具有行波解 $u(x,t) = F(x-at)+G(x+at)$, 由边界条件得
  \[F(0)+G(2x) = \varphi(x),\]
  \[F(2x)+G(0) = \psi(x).\]
  由上式得 $\displaystyle F(x) = \psi\left(\frac x2\right)-G(0)$, $\displaystyle G(x) = \varphi\left(\frac x2\right)-F(0)$.
  取 $(x,t) = (0,0)$, 得
  \[u(0,0) = F(0) + G(0) = \varphi(0) = \psi(0).\]
  从而
  \[ u(x,t) = \psi\left(\frac{x-at}{2}\right)
    + \varphi\left(\frac{x+at}{2}\right)-\varphi(0). \qedhere\]
\end{solve}


\begin{exercise}
	对非齐次波动方程的初值问题(2.5),(2,6), 证明: 当$f(x,t)$不变时,
	
	(1) 如果初始条件在$x$轴的区间$[x_1,x_2]$上发生变化, 那末对应的解在区间$[x_1,x_2]$的影响区域以外不发生变化;
	
	(2) 在$x$轴区间$[x_1,x_2]$上所给的初始条件唯一地确定区间$[x_1,x_2]$的决定区域中解的数值.
\end{exercise}

\begin{proof}
	(1) 非齐次方程初值问题的解为
	$$u(x,t)=\frac{\varphi(x-at)+\varphi(x+at)}{2}+\frac{1}{2a}\int_{x-at}^{x+at}\psi(\alpha)d\alpha+\dfrac{1}{2a}\int_{0}^{t}\int_{x-a(t-\tau)}^{x+a(t-\tau)}f(\xi,\tau)d\xi d\tau.$$
	当初始条件发生变化时, 仅仅引起以上表达式的前两项发生变化, 即仅仅影响到相应齐次方程初值的解.
	
	当$\varphi(x),\psi(x)$在$[x_1,x_2]$上发生变化, 若对任何$t>0$, 有$x+at<x_1$或$x-at>x_2$, 则区间$[x-at,x+at]$整个落在区间$[x_1,x_2]$之外, 由解的表达式知$u(x,t)$不发生变化, 即对$t>0$, 当$x<x_1-at$或$x>x_2+at$, 也就是$(x,t)$落在区间$[x_1,x_2]$的影响域
	$$x_1-at\leq x\leq x_2+at\quad(t>0)$$
	之外,解$u(x,t)$不发生变化.
	
	(2) 区间$[x_1,x_2]$的决定区域为$t>0,x_1+at\leq x\leq x_2-at$.在其中任给$(x,t)$,则
	$$x_1\leq x-at<x+at\leq x_2.$$
	故区间$[x-at,x+at]$完全落在区间$[x_1,x_2]$中.因此$[x_1,x_2]$上所给的初始条件$\varphi(x),\psi(x)$代入达朗贝尔公式唯一地确定出$u(x,t)$的数值.
\end{proof}


\begin{exercise}[5]
  求解
  \[\begin{cases}
    u_{tt} - a^2 u_{xx} = 0,\quad (x>0, t>0), \\
    u|_{t=0} = \varphi(x),\quad u_t|_{t=0} = 0, \\
    u_x - ku_t|_{x=0} = 0,
  \end{cases}\]
  其中 $k$ 为正常数.
\end{exercise}

\begin{solution}
  Suppose the solution is
  \[ u(x,t) = F(x-at) + G(x+at). \]
  Then according to the initial value condition we have
  \begin{equation}\label{eq:a1}
    \begin{aligned}
      u(x,0) & = F(x) + G(x) = \varphi(x), \\
      u_t(x,0) & = -a F'(x) + a G'(x) = 0.
    \end{aligned}
  \end{equation}
  The solution to \eqref{eq:a1} is
  \begin{equation}\label{eq:a2}
    \begin{cases}
      F(x) = \frac12 \varphi(x) + C, \\
      G(x) = \frac12 \varphi(x) - C,
    \end{cases}
  \end{equation}
  where $C$ satisfies
  \begin{equation}\label{eq:a3}
    F(0) + G(0) = 2C.
  \end{equation}
  If $x-at\geq 0$, then
  \[ u(x,t) = \frac12 \bigl(\varphi(x+at) + \varphi(x-at)\bigr). \]
  If $x-at\leq 0$, then by the boundary condition we have
  \begin{equation}\label{eq:a4}
    F'(-at) = \frac{ka-1}{ka+1} G'(at).
  \end{equation}
  Integrate on both sides to get
  \begin{equation}\label{eq:a5}
    F(x) = - \frac{ka-1}{ka+1} G(-x),
  \end{equation}
  where
  \begin{equation}\label{eq:a6}
    C_1 = F(0) + \frac{ka-1}{ka+1} G(0).
  \end{equation}
  Hence by \eqref{eq:a2}, \eqref{eq:a3}, \eqref{eq:a5} and \eqref{eq:a6} we have
  \begin{align*}
    u(x,t)
    & = F(x-at) + G(x+at) \\
    & = - \frac{ka-1}{ka+1} G(at-x) + G(x+at) + C_1 \\
    & = - \frac{ka-1}{2(ka+1)} \varphi(at-x) + \frac{ka-1}{ka+1} C
        + \frac12\varphi(x+at) - C + C_1 \\
    & = \frac{ka-1}{2(ka+1)} \varphi(at-x) + \frac12 \varphi(x+at)
        + \frac{ka}{ka+1} \varphi(0). \qedhere
  \end{align*}
\end{solution}

\begin{exercise}[6]
  求解初边值问题
  \[\begin{cases}
    u_{tt} - u_{xx} = 0,\quad (0<t<kx, k>1), \\
    u|_{t=0} = \varphi_0(x),\quad (x\geq 0), \\
    u_t|_{t=0} = \varphi_1(x),\quad (x\geq 0), \\
    u|_{t=kx} = \psi(x),\quad (x\geq 0),
  \end{cases}\]
  其中 $\varphi_0(0) = \psi(0)$.
\end{exercise}

\begin{solve}
  If $x-t\geq 0$, by d'Alembert formula we have
  \[u(x,t) = \frac{1}{2}(\varphi_0(x-t)+\varphi_0(x+t))
    + \frac{1}{2}\int_{x-t}^{x+t}\varphi_1(\xi)\d\xi.\]
  If $x-t<0$, suppose $u(x,t) = F(x-t) + G(x+t)$, then
  \begin{equation}\label{eq:b1}
    F((1-k)x)+G((1+k)x)=\psi(x).
  \end{equation}
  Since
  \begin{equation}\label{eq:b2}
    F(0)+G(2x)=\frac{1}{2}(\varphi_0(0)+\varphi_0(2x))+\frac{1}{2}\int_0^{2x}\varphi_1(\xi)\d\xi.
  \end{equation}
  It follows that
  \begin{equation}\label{eq:b3}
    F(0)+G((1+k)x) = \frac{1}{2}(\varphi_0(0)+\varphi_0((1+k)x))
      + \frac{1}{2}\int_0^{(k+1)x}\varphi_1(\xi) \d\xi.
  \end{equation}
  By \eqref{eq:b1} and \eqref{eq:b3} we have
  \begin{equation}\label{eq:b4}
    F((1-k)x)-F(0) = \psi(x)-\frac{1}{2}(\varphi_0(0)+\varphi_0((1+k)x))
      - \frac{1}{2}\int_0^{(k+1)x}\varphi_1(\xi) \d\xi.
  \end{equation}
  So
  \begin{equation}\label{eq:b5}
    \begin{aligned}
      F(x-t)-F(0) ={}
      & \psi\left(\frac{x-t}{1-k}\right)-\frac{1}{2}\left(\varphi_0(0)+\varphi_0\left(\frac{1+k}{1-k}(x-t)\right)\right) \\
      & -\frac{1}{2}\int_0^{\frac{k+1}{1-k}(x-t)}\varphi_1(\xi) \d\xi.
    \end{aligned}
  \end{equation}
  By \eqref{eq:b2} we have
  \begin{equation}\label{eq:b6}
    F(0)+G(x+t)=\frac{1}{2}(\varphi_0(0)+\varphi_0(x+t))+\frac{1}{2}\int_0^{x+t}\varphi_1(\xi) \d\xi.
  \end{equation}
  Combining \eqref{eq:b5} and \eqref{eq:b6}, we find
  \[\begin{split}
    u(x,t)
    & = F(x-t)+G(x+t)=\psi\left(\frac{x-t}{1-k}\right)+\frac{1}{2}\left[\varphi_0(x+t)-\varphi_0\left(\frac{1+k}{1-k}(x-t)\right)\right] \\
    & \quad + \frac{1}{2}\int_{\frac{k+1}{1-k}(x-t)}^{x+t}\varphi_1(\xi) \d\xi. \qedhere
  \end{split}\]
\end{solve}


\begin{exercise}
  Solve the following initial value problem
  \[\begin{cases}
    u_{tt} - u_{xx} = 0,\quad f(t) < x < t, \\
    u|_{x=t} = \varphi(t), \\
    u|_{x = f(t)} = \psi(t),
  \end{cases}\]
  where $\varphi(0)=\psi(0)=0$ and $x = f(t)$ is a smooth curve
  passing the origin point and lying between $x=t$ and $x=-t$,
  and $|f'(t)|\neq 1$ for all $t$.
\end{exercise}

\begin{solution}
  Let
  \[ u(x,t) = F(x-t) + G(x+t). \]
  Then
  \begin{equation}\label{eq:a7}
    \begin{cases}
      u(t,t) = F(0) + G(2t) = \varphi(t), \\
      u(f(t),t) = F(f(t)-t) + G(f(t)+t) = \psi(t).
    \end{cases}
  \end{equation}
  By the first equality of \eqref{eq:a7} we have
  \begin{equation}\label{eq:a10}
    G(t) = \varphi\Bigl(\frac{t}{2}\Bigr) - F(0).
  \end{equation}
  Let $s = f(t) - t$, then by the inverse function theorem we know that
  $t$ can be represented as the function of $s$, say, $t = g(s)$.
  Hence $f(t)+t = f(t)-t+2t = s + 2g(s)$ and 
  \begin{equation}\label{eq:a8}
    F(s) = \psi(g(s)) - G(s+2g(s)).
  \end{equation}
  So by \eqref{eq:a8} and \eqref{eq:a10},
  \begin{equation}\label{eq:a9}
    F(x-t) = \psi(g(x-t)) - \varphi\biggl(g(x-t) + \frac{x-t}{2}\biggr) + F(0).
  \end{equation}
  On the other hand,
  \begin{equation}\label{eq:a11}
    G(x+t) = \varphi\Bigl(\frac{x+t}{2}\Bigr) - F(0).
  \end{equation}
  By \eqref{eq:a9} and \eqref{eq:a11} we find
  \[ u(x,t) = \varphi\biggl(\frac{x+t}{2}\biggr)
    - \varphi\biggl(g(x-t) + \frac{x-t}{2}\biggr) + \psi(g(x-t)). \qedhere \]
\end{solution}


\begin{exercise}[8]
  求解波动方程的初值问题
  \[
    \begin{cases}
      \frac{\partial^2u}{\partial t^2} - \frac{\partial^2u}{\partial x^2} = t\sin x, \\
      u|_{t=0} = 0,\; \frac{\partial u}{\partial t}\Big|_{t=0} = \sin x.
    \end{cases}
  \]
\end{exercise}

\begin{solve}
  \[u(x,t) = \frac{1}{2}\int_{x-t}^{x+t}\sin \xi\d\xi
      + \frac{1}{2}\int_0^t\int_{x-t+\tau}^{x+t-\tau}\tau\sin \xi\d\xi\d\tau 
      = t\sin x.\qedhere\]
\end{solve}


\begin{exercise}[9]
  求解波动方程的初值问题
  \[\begin{cases}
    u_{tt} = a^2u_{xx} + \frac{tx}{(1+x^2)^2}, \\
    u|_{t=0} = 0, \\
    u_t|_{t=0} = \frac{1}{1+x^2}.
  \end{cases}\]  
\end{exercise}


\begin{solve}
  \begin{align*}
    u(x,t)
    ={} & \frac{1}{2a}\int_{x-at}^{x+at}\frac{1}{1+\xi^2}\d\xi
      + \frac{1}{2a}\int_0^t\int_{x-a(t-\tau)}^{x+a(t-\tau)}
      \frac{\tau\xi}{(1+\xi^2)^2}\d\xi\d\tau \\
    ={} & -\frac{1}{4a^3}\bigg[\frac{1}{2}\ln\frac{1+(x-at)^2}{1+(x+at)^2}
          - 2at\arctan x \\
        & + (x+at-2a^2)\arctan (x+at) - (x-at-2a^2)\arctan (x-at)\bigg].\qedhere
  \end{align*}
\end{solve}


\section{初边值问题的分离变量法}

\begin{exercise}
  用分离变量法求下列问题的解:
  \begin{enumerate}[(1)]
    \item $\begin{cases}
      \frac{\partial^2u}{\partial t^2} = a^2 \frac{\partial^2u}{\partial x^2}, \\
      \displaystyle u|_{t=0} = \sin\frac{3\pi x}{l},\quad \frac{\partial u}{\partial t}|_{t=0} = x(l-x)\quad (0<x<l), \\
      u(0,t) = u(l,t) = 0.
    \end{cases}$
    \item $\begin{cases}
      \frac{\partial^2u}{\partial t^2} - a^2 \frac{\partial^2u}{\partial x^2} = 0, \\
      u(0,t) = 0, \frac{\partial u}{\partial x}(l,t)=0,\\
      u(x,0) = \frac{h}{l}x,\\
      \frac{\partial u}{\partial t}(x,0) = 0.  
    \end{cases}$
  \end{enumerate}
\end{exercise}

\begin{solve}
	(1)观察到$\displaystyle\sin\frac{3\pi x}l$ 本身具有傅里叶级数的形式,由傅里叶级数的唯一性,得
	$$A_k=\begin{cases}0,&k\neq3,\\1,&k=3.\end{cases}$$
	
	由$x(l-x)$在$[0,l]$上的傅里叶正弦级数的形式,可得
	$$B_k=\frac2{k\pi a}\int_0^l\xi(l-\xi)\sin\frac{k\pi \xi}l\mathrm{d}\xi=\frac{4l^3}{k^4\pi^4a}(1-(-1)^k).$$
	
	于是得到
	$$\begin{aligned}
		u(x,t)&=\cos\frac{3\pi a}lt\sin\frac{3\pi }lx+\frac{4l^3}{\pi^4a}\sum_{k=1}^\infty\frac{1-(-1)^k}{k^4}\sin\frac{k\pi a}lt\sin\frac{k\pi}lx\\
		&=\cos\frac{3\pi a}lt\sin\frac{3\pi }lx+\frac{8l^3}{\pi^4a}\sum_{k=1}^\infty\frac{1}{(2k-1)^4}\sin\frac{(2k-1)\pi a}lt\sin\frac{(2k-1)\pi}lx.
	\end{aligned}$$
  (2) 边界条件是线性的, 故设 $u(x,t)=X(x)T(t)$,由边界条件知 $X(x)$ 满足定解问题
  \[\begin{cases}
    X''(x)+\lambda X(x) = 0, \\
    X(0) = 0,\quad X'(l) = 0.
  \end{cases}\]
  根据 $\lambda$ 的符号分类讨论得
  \[X_k(x)=C_k\sin \frac{(2k+1)\pi}{2l}x,\quad k=0,1,2,\ldots\]
  其中相应的特征值 $\displaystyle\lambda_k=\left(\frac{2k+1}{2l}\pi\right)^2$.
  由 $T''(t)+\lambda_k a^2T(t)=0$ 解得
  \[T_k(t) = A_k\cos\frac{(2k+1)a\pi}{2l}t+B_k\sin \frac{(2k+1)a\pi}{2l}t.\]
  于是
  \[u(x,t) = \sum_{k=0}^{\infty}\left(A_k\cos\frac{(2k+1)\pi a}{2l}t
    + B_k\sin \frac{(2k+1)\pi a}{2l}t\right)\sin \frac{(2k+1)\pi}{2l}x.\]
  再根据初始条件得
  \[\sum_{k=0}^{\infty}A_k\sin \frac{(2k+1)\pi}{2l}x=\frac{h}{l}x,\]
  \[\sum_{k=0}^{\infty}B_k\frac{(2k+1)\pi a}{2l}\sin \frac{(2k+1)\pi}{2l}x = 0.\]
  利用三角函数序列 $\displaystyle\Bigl(\sin \frac{(2k+1)\pi}{2l}x\Bigr)_{k\geq 0}$
  在区间$[0,l]$上的正交性, 即
  \[\int_0^l\sin \frac{(2m+1)\pi}{2l}x\cdot\sin \frac{(2n+1)\pi}{2l}x\diff x
    = \frac{l}{2}\delta_{mn},\]
  得
  \[A_k=\frac{2}{l}\int_0^l\frac{h}{l}\xi\sin \frac{(2k+1)\pi}{2l}\xi\diff \xi
    =(-1)^k\frac{8h}{(2k+1)^2\pi^2},\quad B_k = 0.\]
  因此
  \[ u(x,t) = \sum_{k=0}^{\infty}(-1)^k\frac{8h}{(2k+1)^2\pi^2}\cos\frac{(2k+1)\pi at}{2l}
    \sin\frac{(2k+1)\pi x}{2l}. \qedhere \]
\end{solve}

\begin{remark}
  $\displaystyle\int_{-l}^l\sin\alpha x\sin\beta x\diff x=0$ 及 $\displaystyle\int_0^l\sin\alpha x\sin\beta x\diff x=0$
  的充要条件为 $(\alpha\pm\beta)l=k\pi\neq 0$. 而且正弦函数于余弦函数总是正交的, 
  即 $\displaystyle\int_{-l}^l\sin\alpha x\cos\beta x\equiv 0$。
\end{remark}


\begin{exercise}
  设弹簧一端固定, 一端在外力作用下做周期振动, 此时定解问题归结为
  \[\begin{cases}
    \displaystyle\frac{\partial^2u}{\partial t^2} = a^2 \frac{\partial^2u}{\partial x^2}, \\
    u(0,t) = 0, \quad u(l,t) = A\sin^2\omega t, \\
    u(x,0) = u_t(x,0) = 0.
  \end{cases}\]
  求解此问题.
\end{exercise}

\begin{solve}
  边界条件非齐次,故令$\displaystyle U(x,t)=\frac{x}{l}A\sin^2\omega t$,
  $V(x,t)=u(x,t)-U(x,t)$, 则 $V(x,t)$ 满足的定解问题是
  \[\begin{cases}
    \displaystyle\frac{\partial^2V}{\partial t^2}-a^2\frac{\partial^2V}{\partial x^2}
      = -\frac{2\omega^2A}{l}x\cos 2\omega t, \\
    V(0,t)=0,\quad V(l,t)=0, \\
    \displaystyle V(x,0)=0,\quad \frac{\partial V(x,0)}{\partial t} = 0.
  \end{cases}\]
  运用齐次化原理知该问题的解为
  \[u(x,t)=\sum_{k=1}^{\infty}\int_0^tB_k(\tau)\sin\frac{k\pi a}{l}(t-\tau)\diff\tau
    \cdot\sin\frac{k\pi}{l}x.\]
  其中
  \[\begin{split}
    B_k(\tau)
    & = \frac{2}{k\pi a}\int_0^lf(\xi,\tau)\sin\frac{k\pi}{l}\xi\diff\xi \\
    & = \frac{2}{k\pi a}\int_0^l-\frac{2\omega^2A}{l}\xi\cos2\omega\tau
      \sin\frac{k\pi}{l}\xi\diff\xi \\
    & = \frac{4(-1)^k\omega^2lA\cos2\omega\tau}{k^2\pi^2a}.\qedhere
  \end{split}\]
\end{solve}



\begin{exercise}
	求弦振动方程
	$$u_{tt}-a^2u_{xx}=0\quad(0<x<l,t>0)$$
	满足以下定解条件的解：
	$$\begin{aligned}
		(1)&u|_{x=0}=u_{x}|_{x=l}=0,\\
		&u|_{t=0}=\sin\frac{3}{2l}\pi x,u_{t}|_{t=0}=\sin\frac{5}{2l}\pi x;\\
		(2)&u_{x}|_{x=0}=u_{x}|_{x=l}=0,\\
		&u|_{t=0}=x,u_{t}|_{t=0}=0.
	\end{aligned}$$
\end{exercise}

\begin{solve}
	(1)$$u(x,t)=\sum_{k=0}^{\infty}\left(A_{k}\cos\frac{2k+1}{2l}a\pi t+B_{k}\sin\frac{2k+1}{2l}a\pi t\right)\sin\frac{2k+1}{2l}\pi x.$$
	代入初值条件可得
	$$ A_{k} =\begin{cases}1,&k=1,\\0,&k\neq1,\end{cases}\quad B_k=\begin{cases}\frac{2l}{5\pi a},&k=2,\\0,&k\neq2.\end{cases}$$
	则
	$$u(x,t)=\cos\frac{3a\pi}{2l}t\sin\frac{3\pi}{2l}x+\frac{2l}{5a\pi}\sin\frac{5a\pi}{2l}t\sin\frac{5\pi}{2l}x.$$
	
	(2)由分离变量法知, 方程有特解
	$$u(x,t) = \mathop{{\sum}}_{k = 0}^{\infty}\left(A_{k}\cos\frac{k\pi a}{l}t + B_{k}\sin\frac{k\pi a}{l}t \right)\cos\frac{k\pi}{l}x,$$
	其中
	$$\begin{aligned}
		&A_{0} = \frac{1}{l}{{\int}}_{0}^{l}\varphi(\xi)d\xi = \frac{l}{2},\\
		&A_{k} = \frac{2}{l}{{\int}}_{0}^{l}x\cos\frac{k\pi}{l}xdx = \frac{2l}{{(k\pi)}^{2}}\left\lbrack {({-}1)}^{k} {-} 1 \right\rbrack,\\
		&B_{k} = \frac{2}{k\pi a}{{\int}}_{0}^{l}0 {\cdot} \cos\frac{k\pi}{l}xdx = 0.
	\end{aligned}$$
	于是
	\[u(x,t) = \frac{l}{2} + \mathop{{\sum}}\limits_{k = 1}^{{\infty}}\frac{2l}{{(k\pi)}^{2}}\left\lbrack {({-}1)}^{k} {-} 1 \right\rbrack\cos\frac{k\pi a}{l}t\cos\frac{k\pi}{l}x.\qedhere\]
\end{solve}


\begin{exercise}[4]
  用分离变量法求解初边值问题:
  \[\begin{cases}
    u_{tt} - a^2 u_{xx} = g,\quad 0<x<l,\quad t>0, \\
    u|_{x=0} = u_x|_{x=l} = 0, \\
    u|_{t=0} = 0,\quad u_t|_{t=0} =\sin\frac{\pi x}{2l}.
  \end{cases}\]
  其中 $g$ 为常数.
\end{exercise}

\begin{solve}
	设$u(x,t)=v(x,t)+w(x)$, 其中$w(x)$是常微分方程边值问题
	\[\begin{cases}
		-a^2w''(x)=g, \\
		w(0)=0,\quad w'(l)=0.
	\end{cases}\]
	的解.解得
	$$w(x)=\frac{g}{2a^2}x(2l-x).$$
  于是 $\displaystyle v(x,t)=u(x,t)+\frac{g}{2a^2}x(x-2l)$, 且满足齐次方程和齐次边界情形
  \[\begin{cases}
    v_{tt}-a^2v_{xx}=0,0<x<l,t>0, \\
    v(0,t)=\frac{\partial v}{\partial x}(l,t)=0, \\
    v(x,0)=\frac{g}{2a^2}x(x-2l),\quad\frac{\partial v}{\partial t}(x,0)=\sin\frac{\pi x}{2l}.
  \end{cases}\]
  令
  \[ v(x,t) = X(x)T(t). \]
  于是
  \[ \frac{X''(x)}{X(x)} = \frac{T''(t)}{T(t)} = -\lambda. \]
  First of all, since $X''(x) + \lambda X(x) = 0$ with $X(0) = X'(l) = 0$, we have
  \begin{itemize}
    \item If $\lambda\leq 0$, there only exists trivial solution $X\equiv 0$;
    \item If $\lambda>0$, we have $\displaystyle \lambda_k = \bigl(\frac{(2k+1)\pi}{2l}\bigr)^2$
      and $\displaystyle X_k(x) = C_k \sin\frac{(2k+1)\pi}{2l}x$.
  \end{itemize}
  On the other hand, since $T(t)$ satisfies
  \[ T''(t) + \biggl(\frac{(2k+1)\pi a}{2l}\biggr)^2 T = 0. \]
  We can solve that
  \begin{equation}\label{eq:a12}
    T_k(t) = A_k \cos \frac{(2k+1)\pi a}{2l} t + B_k \sin \frac{(2k+1)\pi a}{2l} t.
  \end{equation}
  Therefore
  \begin{equation}\label{eq:a13}
    v(x,t) = \sum_{k=0}^\infty \left(A_k\cos\frac{(2k+1)\pi a}{2l}t+B_k\sin\frac{(2k+1)\pi a}{2l}t\right)\sin\frac{(2k+1)\pi}{2l}x.
  \end{equation}
  Combining with the initial value condition we have
  \begin{equation}\label{eq:a14}
    \begin{aligned}
      &A_k=\frac{2}{l}\int_0^l\frac{g}{2a^2}x(x-2l)\sin\frac{(2k+1)\pi}{2l}x\diff x=-\frac{16gl^2}{(2k+1)^3\pi^3a^2}, \\
      &B_k=\begin{cases}\frac{2l}{\pi a},&k=0,\\0,&k\geq1.\end{cases}
    \end{aligned}
  \end{equation}
  Therefore,
  \begin{align*}
    u(x,t)
    ={} & \sum_{k=0}^{\infty}\left(A_k\cos\frac{(2k+1)\pi a}{2l}t+B_k\sin\frac{(2k+1)\pi a}{2l}t\right)\sin\frac{(2k+1)\pi}{2l}x - \frac{g}{2a^2}x(x-2l),\\
    ={} & \frac{2l}{\pi a}\sin\frac{\pi a}{2l}t\sin\frac{\pi}{2l}x-\frac{16gl^2}{\pi^3 a^2}\sum_{k=0}^{\infty}\frac{1}{(2k+1)^3}\cos\frac{(2k+1)\pi a}{2l}t\sin\frac{(2k+1)\pi}{2l}x \\
    &- \frac{g}{2a^2}x(x-2l).
  \end{align*}
\end{solve}


\begin{exercise}
  用分离变量法求下面问题的解:
  \[\begin{cases}
    \frac{\partial^2u}{\partial t^2} = a^2 \frac{\partial^2u}{\partial x^2} + b\sinh x, \\
    u|_{x=0} = u|_{x=l} = 0, \\
    u|_{t=0} = u_t|_{t=0} = 0.
  \end{cases}\]
\end{exercise}

\begin{solve}
  利用齐次化原理,方程的解为
  \[u(x,t)=\int_0^tW(x,t;\tau)\diff\tau,\]
  其中$W$为下面方程的解:
  \[\begin{cases}
    \frac{\partial^2W}{\partial t'^2}-a^2\frac{\partial^2W}{\partial x^2}=0,t'>0, \\
    W|_{t'=0} = 0,\quad\frac{\partial W}{\partial t'}|_{t'=0} = b\sinh x, \\
    W|_{x=0} = W|_{x=l} = 0.
  \end{cases}\]
  其通解为
  \[W(x,t;\tau) = \sum_{k=1}^{\infty}\left(A_k\cos\frac{k\pi a}{l}t'
    + B_k\sin\frac{k\pi a}{l}t'\right)\sin\frac{k\pi}{l}x,\]
  其中
  \[A_k = 0,\quad k=1,2,\cdots\]
  \[B_k = \frac{2}{k\pi a}\int_0^l b\sinh x\sin\frac{k\pi}{l}x\diff x
    = (-1)^{k+1}\frac{2bl\sinh l}{a(l^2+k^2\pi^2)}.\]
  故原方程解为
  \[ u(x,t) = \frac{2bl^2\sinh l}{\pi a^2}
      \sum_{k=1}^{\infty}\frac{(-1)^{n+1}}{n(l^2+n^2\pi^2)}
      \left(1-\cos\frac{n\pi at}{l}\right)\sin\frac{n\pi x}{l}. \qedhere \]
\end{solve}


\begin{exercise}
  Solve the following problem by separation of variables:
  \[\begin{cases}
    \frac{\partial^2 u}{\partial t^2} + 2b \frac{\partial u}{\partial t}
      = a^2 \frac{\partial^2u}{\partial x^2} \quad (b>0), \\
    u|_{x=0} = u|_{x=l} = 0, \\
    u|_{t=0} = \frac{h}{l}x,\ \frac{u}{t}\big|_{t=0} = 0.
  \end{cases}\]
\end{exercise}

\begin{solution}
  Let $u(x,t) = X(x)T(t)$, then
  \[\frac{T''+2bT'}{a^2T} = \frac{X''}{X} = -\lambda. \]

  First of all, $X'' + \lambda X = 0$.
  \begin{itemize}
    \item If $\lambda\leq 0$, there only exists trivial solution $X\equiv 0$;
    \item If $\lambda>0$, then $\lambda_k = \bigl(\frac{k\pi}{l}\bigr)^2$
      and $X_k(x) = C_k\sin\frac{k\pi x}{l}$.
  \end{itemize}

  Thus $T$ satisfies the equation
  \[ T'' + 2bT' + \biggl(\frac{k\pi a}{l}\biggr)^2 T = 0, \]
  of which the characteristic equation is
  \[ \lambda^2 + 2b\lambda + \biggl(\frac{k\pi a}{l}\biggr)^2 = 0. \]

  We suppose that $b$ is sufficiently small such that
  $\Delta = 4b^2 - 4\bigl(\frac{k\pi a}{l}\bigr)^2 < 0$ for all $k\geq 1$, then
  \[\lambda = -b \pm \sqrt{\Bigl(\frac{k\pi a}{l}\Bigr)^2 - b^2}i, \]
  and
  \[ T_k(t) = \e^{-bt} \biggl(A_k \sin \sqrt{\Bigl(\frac{k\pi a}{l}\Bigr)^2 - b^2} t
    + B_k \cos \sqrt{\Bigl(\frac{k\pi a}{l}\Bigr)^2 - b^2} t\biggr). \]
  Therefore,
  \[ u(x,t) = \e^{-bt} \sum_{k=1}^\infty \sin\frac{k\pi x}{l}
      \biggl(A_k \sin \sqrt{\Bigl(\frac{k\pi a}{l}\Bigr)^2 - b^2} t
      + B_k \cos \sqrt{\Bigl(\frac{k\pi a}{l}\Bigr)^2 - b^2} t\biggr). \]
  Combining with the initial value condition we have
  \[u|_{t=0} = \sum_{k=1}^\infty B_k \sin\frac{k\pi x}{l} = \frac{h}{l}x, \]
  and
  \[u_t|_{t=0} = -b\sum_{k=1}^\infty B_k \sin\frac{k\pi x}{l}
    + \sum_{k=1}^\infty A_k \sqrt{\Bigl(\frac{k\pi a}{l}\Bigr)^2-b^2}
      \sin\frac{k\pi x}{l} = 0,\]
  from which we solve that
  \[ B_k = \frac{(-1)^{k+1}2h}{k\pi},\qquad
    A_k = \frac{(-1)^{k+1}2bh}{k\pi\sqrt{\bigl(\frac{k\pi a}{l}\bigr)^2-b^2}}. \qedhere \]
\end{solution}


\begin{exercise}[7]<补充题目>
  验证 $\displaystyle u(x,t) = \int_0^t W(x,t;\tau)\diff\tau$ 是初边值问题 (3.23)--(3.25) 的解.
\end{exercise}

\begin{proof}
  由于 $W(x,t;\tau)$ 满足条件
  \[\begin{cases}
    \frac{\partial^2W}{\partial t^2} - a^2 \frac{\partial^2W}{\partial x^2} = 0\quad (t>\tau), \\
    t = \tau: W=0,\,\frac{\partial W}{\partial t} = f(x,\tau), \\
    W(0,t;\tau) = W(l,t;\tau) = 0.
  \end{cases}\]
  故当 $t=0$ 时, $u(x,0) = 0$, $u_t(x,0) = W(x,0;0) = 0$.
  当 $x=0$ 时,
  \[u(0, t) = \int_0^t W(0,t;\tau)\diff\tau = 0.\]
  当 $x=l$ 时,
  \[u(l, t) = \int_0^t W(l,t;\tau)\diff\tau = 0.\]
  所以 $u(x,t)$ 满足初边值条件 (3.24), (3.25). 下面验证 $u(x,t)$ 满足方程 (3.23).
  由于 $\displaystyle u(x,t) = \int_0^t W(x,t;\tau)\diff\tau$, 故
  \[\frac{\partial u}{\partial t} = W(x,t;t) + \int_0^t \frac{\partial W}{\partial t}\diff\tau
    = \int_0^t \frac{\partial W}{\partial t}(x,t;\tau)\diff\tau.\]
  再求导可得
  \begin{align*}
    \frac{\partial^2u}{\partial t^2}
    & = \frac{\partial W}{\partial t}(x,t;t)
      + \int_0^t \frac{\partial^2W}{\partial t^2}(x,t;\tau)\diff\tau \\
    & = f(x,t) + \int_0^t \frac{\partial^2W}{\partial t^2}(x,t;\tau)\diff\tau.
  \end{align*}
  又因为
  \[\frac{\partial^2u}{\partial x^2} 
    = \int_0^t \frac{\partial^2W}{\partial x^2}(x,t;\tau)\diff\tau.\]
  于是
  \begin{align*}
    \frac{\partial^2u}{\partial t^2} - a^2 \frac{\partial^2u}{\partial x^2}
    & = f(x,t) + \int_0^t \biggl(\frac{\partial ^2W}{\partial t^2}(x,t;\tau)
      - a^2 \frac{\partial^2W}{\partial x^2}(x,t;\tau)\biggr)\diff\tau \\
    & = f(x,t).\qedhere
  \end{align*}
\end{proof}


\section{高维波动方程的柯西问题}


\begin{note}[Wallis公式]
	(1)
	$$\int_0^{\frac{\pi}{2}}\sin^nx\mathrm dx=\int_0^{\frac{\pi}{2}}\cos^nx\mathrm dx=\begin{cases}\frac{n-1}{n}\cdot\frac{n-3}{n-2}\cdots\frac{2}{3}\cdot1,&n\text{为奇数,}\\\frac{n-1}{n}\cdot\frac{n-3}{n-2}\cdots\frac{1}{2}\cdot\frac{\pi}{2},&n\text{为偶数.}\end{cases}$$
	
	(2)
	$$\int_0^\pi\sin^nx\mathrm{d}x=2\int_0^{\frac{\pi}{2}}\sin^nx\mathrm{d}x,$$
	$$\int_0^\pi\cos^nx\mathrm{d}x=\begin{cases}0,&n\text{为奇数,}\\2\cdot\frac{n-1}{n}\cdot\frac{n-3}{n-2}\cdot\cdots\frac{1}{2}\cdot\frac{\pi}{2},&n\text{为偶数.}\end{cases}$$
	
	(3)
	$$\int_0^{2\pi}\sin^nx\mathrm{d}x=\int_0^{2\pi}\cos^nx\mathrm{d}x=\begin{cases}0,&n\text{为奇数,}\\4\cdot\frac{n-1}{n}\cdot\frac{n-3}{n-2}\cdots\frac{1}{2}\cdot\frac{\pi}{2},&n\text{为偶数.}\end{cases} $$
\end{note}

\begin{exercise}
  利用泊松公式求解波动方程的柯西问题:
  \begin{enumerate}[(1)]
    \item $\begin{cases}
            u_{tt} = a^2(u_{xx}+u_{yy}+u_{zz}), \\
            u|_{t=0}=0,\; u_t|_{t=0}=x^2+yz;
          \end{cases}$
    \item $\begin{cases}
            u_{tt} = a^2(u_{xx}+u_{yy}+u_{zz}), \\
            u|_{t=0}=x^3+y^2z,\; u_t|_{t=0}=0.
           \end{cases}$
  \end{enumerate}
\end{exercise}

\begin{solve}
  (1) 由 Poisson 公式得
  \begin{align*}
    u(x,y,x,t)
    ={} & \frac{\partial}{\partial t}\left(\frac{1}{4\pi a^2t}\iint_{S_{at}(M)}0\diff S\right) + \frac{1}{4\pi a^2t}\iint_{S_{at}(M)}(\xi^2+\eta\zeta)\diff S \\
    ={} & \frac{1}{4\pi a^2t}\int_0^{\pi}\int_0^{2\pi} \bigl[(x+at\sin\theta\cos\varphi)^2 \\
        & + (y+at\sin\theta\sin\varphi)(z+at\cos\theta) \bigr]
          a^2t^2\sin\theta\diff\varphi\diff\theta \\
    ={} & (x^2+	yz)t + \frac13a^2t^3.
  \end{align*}

  (2) 由 Poisson 公式得
  \begin{align*}
    u(x,y,z,t)
    & = \frac{\partial}{\partial t} \biggl(\frac{1}{4\pi a^2 t}\iint_{S_{at}(M)} \xi^3
        + \zeta^2\eta \d S\biggr) \\
    & = \frac{\partial}{\partial t} \biggl(\frac{1}{4\pi a^2 t} \int_0^\pi \int_0^{2\pi}
        \bigl[ (x+at\sin\theta\cos\varphi)^3 \\
    & \qquad + (y+at\sin\theta\varphi)^2(z+at\cos\theta) \bigr] 
        a^2t^2\sin\theta \d \varphi \d \theta\biggr) \\
    & = x^3 + y^2z + 3a^2t^2x + a^2t^2z. \qedhere
  \end{align*}
\end{solve}


\begin{exercise}
  试用降维法导出弦振动方程的达朗贝尔公式.
\end{exercise}

\begin{solve}
  考虑一维波动方程
  \[\begin{cases}
    u_{tt} = a^2 u_{xx}, \\
    u|_{t=0} = \varphi(x), \\
    u_t|_{t=0} = \psi(x).
  \end{cases}\]
  令 $\tilde{u}(x,y,z,t) = u(x,t)$, $\tilde{\varphi}(x,y,z) = \varphi(x)$,
  $\tilde{\psi}(x,y,z) = \psi(x)$, 则 $\tilde{u}$ 满足三维波动方程
  \[\begin{cases}
    \tilde{u}_{tt} = a^2 \bigl(\tilde{u}_{xx} + \tilde{u}_{yy} + \tilde{u}_{zz}\bigr), \\
    \tilde{u}|_{t=0} = \tilde{\varphi}, \\
    \tilde{u}_t|_{t=0} = \tilde{\psi}.
  \end{cases}\]
  由 Poisson 公式得
  \[
    \tilde{u}(x, y, z, t) = \frac{\partial}{\partial t}
      \biggl(\frac{1}{4\pi a^2t} \iint_{S_{at}(M)} \tilde{\varphi}(\xi,\eta,\zeta)\diff S\biggr)
      + \frac{1}{4\pi a^2t} \iint_{S_{at}(M)} \tilde{\psi}(\xi,\eta,\zeta)\diff S.
  \]
  于是
  \[
    u(x,t)
    = \frac{\partial}{\partial t}
      \biggl(\frac{1}{4\pi a^2t} \iint_{S_{at}(M)} \varphi(\xi)\diff S\biggr)
      + \frac{1}{4\pi a^2t} \iint_{S_{at}(M)} \psi(\xi)\diff S.
  \]
  采用球坐标 $\xi = x + r\cos\theta$, $\eta = y + r\sin\theta\cos\psi$, $\zeta = z + r\sin\theta\sin\phi$, 其中 $r=at$, $0\leq\theta\leq\pi$, $0\leq\phi < 2\pi$. 则
  \begin{align*}
    u(x,t)
    ={} & \frac{\partial}{\partial t}
          \biggl(\frac{1}{4\pi a} \int_0^{2\pi} \int_0^{\pi} \varphi(x+r\cos\theta)
          r\sin\theta \diff\theta\diff\phi\biggr) \\
        & + \frac{1}{4\pi a} \int_0^{2\pi} \int_0^{\pi} \psi(x+r\cos\theta)
          r\sin\theta \diff\theta\diff\phi  \\
    ={} & \frac{\partial}{\partial t}
          \biggl(-\frac{1}{2a} \int_0^{\pi} \varphi(x+r\cos\theta) 
          \diff (x+r\cos\theta)\biggr) \\
        &  - \frac{1}{2a} \int_0^{\pi} \psi(x+r\cos\theta) \diff (x+r\cos\theta) \\
    ={} & \frac{\partial}{\partial t}
          \biggl(-\frac{1}{2a} \int_{x+at}^{x-at} \varphi(\xi) \diff\xi\biggr)
          - \frac{1}{2a} \int_{x+at}^{x-at} \psi(\xi) \diff\xi \\
    ={} & \frac{1}{2}\bigl(\varphi(x+at) + \varphi(x-at)\bigr)
          + \frac{1}{2a}\int_{x-at}^{x+at} \psi(\xi)\diff\xi. \qedhere
  \end{align*}
\end{solve}


\begin{exercise}
  求解平面波动方程的柯西问题:
  \begin{enumerate}[(1)]
    \item $\begin{cases}
            u_{tt} = a^2(u_{xx}+u_{yy}), \\
            u|_{t=0}=x^2(x+y), \\
            u_t|_{t=0}=0;
          \end{cases}$
    \item $\begin{cases}
            u_{tt} - 3(u_{xx}+u_{yy}) = x^3+y^3, \\
            u|_{t=0}=0, \\
            u_t|_{t=0}=x^2.
          \end{cases}$
  \end{enumerate}
\end{exercise}

\begin{solve}
  (1) 由 Poisson 公式得
  \begin{align*}
    u(x,y,t)
    & = \frac{1}{2\pi a}\frac{\partial}{\partial t}\int_0^{at}\int_0^{2\pi}\frac{\varphi(x         
      + r\cos\theta,y+r\sin\theta)}{\sqrt{(at)^2-r^2}}r\diff\theta\diff r \\
    & = \frac{1}{2\pi a}\frac{\partial}{\partial t}\int_0^{at}
      \int_0^{2\pi}\frac{(x+r\cos\theta)^2
      (x+y+r\cos\theta+r\sin\theta)}{\sqrt{a^2t^2-r^2}}r\diff\theta\diff r \\
    & = \frac{1}{2\pi a}\frac{\partial}{\partial t}
      \int_0^{at}\frac{\pi\left[2x^2(x+y)+r^2(3x+y)\right]}{\sqrt{a^2t^2-r^2}}r\diff r \\
    & = \frac{1}{2\pi}\frac{\partial}{\partial t}\int_0^{\frac{\pi}{2}}
      \frac{2x^2(x+y)+a^2t^2\sin^2\beta(3x+y)}{at\cos\beta}
      at\sin\beta\cdot at\cos\beta \diff\beta \\
    & = \frac{1}{2a}\frac{\partial}{\partial t}\left(2x^2(x+y)at+\frac{2}{3}a^3t^2(3x+y)\right)\\
    & = x^2(x+y)+a^2t^2(3x+y).
  \end{align*}

  (2) First of all, we consider the homogeneous equation
  \begin{equation}\label{eq:a15}
    \begin{cases}
      u_{tt} = 3(u_{xx} + u_{yy}), \\
      u|_{t=0} = 0, \\
      u_t|_{t=0} = x^2.
    \end{cases}
  \end{equation}
  By Poisson's formula, the solution to~\eqref{eq:a15} is
  \begin{equation}\label{eq:a16}
    \begin{aligned}
      u_1(x,y,t) = \frac{1}{2\sqrt{3}\pi} \int_0^{\sqrt3 t}\int_0^{2\pi} \frac{(x+r\cos\theta)^2}{\sqrt{3t^2 - r^2}} r \d\theta\d r = x^2 t + t^3.
    \end{aligned}
  \end{equation}
  Then we consider the nonhomogeneous equation with homogeneous initial condition
  \begin{equation}\label{eq:a17}
    \begin{cases}
      u_{tt} = 3(u_{xx}+u_{yy}) + x^3 + y^3, \\
      u|_{t=0} = 0, \\
      u_t|_{t=0} = 0.
    \end{cases}
  \end{equation}
  By Duhamel's principle, the solution to~\eqref{eq:a17} is
  \begin{equation}\label{eq:18}
    u_2(x,y,t) = \int_0^t w(x,y,t;\tau) \d\tau,
  \end{equation}
  where $w$ is the solution to
  \[\begin{cases}
    w_{tt} = 3(w_{xx} + w_{yy}), \\
    w|_{t=\tau} = 0, \\
    w_t|_{t=\tau} = x^3 + y^3.
  \end{cases}\]
  By Poisson's formula we have
  \[ w(x,y,t;\tau) = (t-\tau)(x^3+y^3) + 3(t-\tau)^3(x+y). \]
  Hence
  \begin{equation}\label{eq:a19}
    \begin{aligned}
      u_2(x,y,t) 
      & = \int_0^t (t-\tau)(x^3+y^3) + 3(t-\tau)^3(x+y) \d\tau \\
      & = \frac{t^2}{2}(x^3+y^3) + \frac{3}{4}t^4 (x+y).
    \end{aligned}
  \end{equation}
  By \eqref{eq:a16} and \eqref{eq:a19} we find the solution to the original
  equation is
  \begin{equation}\label{eq:a20}
    u(x,y,t) = x^2t + t^3 + \frac{t^2}{2}(x^3+y^3) + \frac{3}{4}t^4 (x+y).
  \end{equation}
\end{solve}


\begin{exercise}
  求二维波动方程的轴对称解 (即二维波动方程形如 $u=u(r,t)$ 的解, 其中 $r=\sqrt{x^2+y^2}$).
\end{exercise}

\begin{solve}
  由于 $\Delta u = u_{rr} + \frac{1}{r}u_r$, 故轴对称解满足方程
  \[u_{tt} = a^2\biggl(u_{rr}+\frac{1}{r}u_r\biggr).\]
  令 $u(r,t) = R(r)T(t)$, 代入上述方程得
  \[\frac{T''(t)}{a^2T(t)} = \frac{R''(r)+\frac{1}{r}R'(r)}{R(r)} = -\lambda^2
    \quad (\lambda>0).\]
  故
  \[T(t) = C_1\cos a\lambda t + C_2\sin a\lambda t,
    \quad R(r) = {\rm J}_0(\lambda r),\]
  其中 ${\rm J}_0$ 为 0 阶 Bessel 函数, 见附录 \uppercase\expandafter{\romannumeral3}.
\end{solve}


\begin{exercise}
  求解柯西问题:
  \[\begin{cases}
    u_{tt} = a^2(u_{xx}+u_{yy}) + c^2u, \\
    u|_{t=0} = \varphi(x,y), \\
    u_t|_{t=0} = \psi(x,y).
  \end{cases}\]
\end{exercise}

\begin{solve}
  令 $v(x,y,z,t) = \e^{\frac{cz}{a}} u(x,y,t)$, 则
  \[\begin{cases}
    v_{tt} = a^2(v_{xx} + v_{yy} + v_{zz}), \\
    v|_{t=0} = \e^{\frac{cz}{a}}\varphi(x,y), \\
    v_t|_{t=0} = \e^{\frac{cz}{a}}\psi(x,y).
  \end{cases}\]
  由三维波动方程柯西问题解的 Poisson 公式得
  \[ v(x,y,z,t) = \frac{\partial}{\partial t}
    \biggl(\frac{1}{4\pi a^2t}\iint_{S_{at}(M)} \e^{\frac{c\zeta}{a}}\varphi(\xi,\eta)\d S\biggr)
    + \frac{1}{4\pi a^2t}\iint_{S_{at}(M)} \e^{\frac{c\zeta}{a}}\psi(\xi,\eta)\d S. \qedhere \]
\end{solve}


\begin{exercise}[6]
  试用齐次化原理导出平面非齐次波动方程
  \[u_{tt} = a^2(u_{xx}+u_{yy})+f(x,y,t)\]
  在齐次初始条件
  \[\begin{cases}
    u|_{t=0} = 0, \\
    u_t|_{t=0} = 0
  \end{cases}\]
  下的求解公式.
\end{exercise}

\begin{solve}
  由齐次化原理$u(x,y,t)=\int_0^tw(x,y,t;\tau)\diff\tau$, 其中 $w(x,y,t;\tau)$为以下定解问题的解:
  \[\begin{cases}
    w_{tt} = a^2(w_{xx}+w_{yy})\quad (t>\tau), \\
    w|_{t=\tau} = 0,\quad w_t|_{t=\tau} = f(x,y,\tau).
  \end{cases}\]
  由二维波动方程柯西问题的泊松公式有:
  \[\begin{split}
    w(x,y,t;\tau)
    & = \frac{1}{2\pi a}\iint_{\Sigma_{at'}^M}
      \frac{f(\xi,\eta,\tau)}{\sqrt{(at')^2
      -(\xi-x)^2-(\eta-y)^2}}\diff\xi\diff\eta\quad(t'=t-\tau)\\
    & = \frac{1}{2\pi a}\iint_{\Sigma_{a(t-\tau)}^M}
      \frac{f(\xi,\eta,\tau)}{\sqrt{a^2(t-\tau)^2-(\xi-x)^2-(\eta-y)^2}}
      \diff\xi\diff\eta.
  \end{split}\]
  故
  \begin{align*}
    u(x,y,t)
    & = \int_0^tw(x,y,t;\tau)\diff\tau \\
    & = \frac{1}{2\pi a}\int_0^t\iint_{\Sigma_{a(t-\tau)}^M}
      \frac{f(\xi,\eta,\tau)}{\sqrt{a^2(t-\tau)^2-(\xi-x)^2-(\eta-y)^2}}
      \diff\xi\diff\eta\diff\tau.\qedhere
  \end{align*}
\end{solve}


\begin{exercise}
  用降维法求解上面的问题.
\end{exercise}

\begin{solve}
  令 $\tilde{u}(x,y,z,t) = u(x,y,t)$, $\tilde{f}(x,y,z,t)=f(x,y,t)$, 则
  \[\begin{cases}
    \tilde{u}_{tt} = a^2\bigl(\tilde{u}_{xx}+\tilde{u}_{yy}+\tilde{u}_{zz}\bigr)
      + \tilde{f}(x,y,z,t), \\
    \tilde{u}|_{t=0} = 0, \\
    \tilde{u}_t|_{t=0} = 0.
  \end{cases}\]
  上述问题的解已由教材 (4.47) 式给出, 即
  \[\tilde{u}(x,y,z,t)
    = \frac{1}{4\pi a^2}\iiint_{r\leq at} 
      \frac{\tilde{f}(\xi,\eta,\zeta,t-\frac{r}{a})}{r}\d V.\]
  故
  \begin{align*}
    u(x,y,t)
    & = \frac{1}{4\pi a^2}\iiint_{r\leq at} \frac{f(\xi,\eta,t-\frac{r}{a})}{r}\d V \\
    & = \frac{1}{4\pi a^2}\int_0^{at} 
      \iint_{S_r^M} \frac{f(\xi, \eta, t-\frac{r}{a})}{r}\d S_r \d r \\
    & = \frac{1}{2\pi a^2} \int_0^{at} \iint_{\Sigma_r^M} \frac{f(\xi,\eta,t-\frac{r}{a})}
      {\sqrt{r^2-(\xi-x)^2-(\eta-y)^2}}\d\xi\d\eta\d r.\qedhere
  \end{align*}
\end{solve}


\begin{exercise}[8]
  解非齐次方程的柯西问题:
  \[\begin{cases}
    u_{tt} = u_{xx}+u_{yy}+u_{zz}+2(y-t), \\
    u|_{t=0} = 0, \\
    u_t|_{t=0} = x^2+yz.
  \end{cases}\]
\end{exercise}

\begin{solve}
  利用叠加原理,考虑下面两个定解问题:
  \[(\star)
  \begin{cases}
    u_{tt}=u_{xx}+u_{yy}+u_{zz}, \\
    u|_{t=0}=0, \\
    u_t|_{t=0}=x^2+yz.
  \end{cases}
  (\star\star)
  \begin{cases}
    u_{tt} = u_{xx}+u_{yy}+u_{zz}+2(y-t), \\
    u|_{t=0}=0, \\
    u_t|_{t=0}=0.
  \end{cases}\]
  首先 $(\star)$ 的解为
  \[u_1(x,y,z,t) = \frac{1}{4\pi t}\iint_{S_t(M)}(\xi^2+\eta\zeta)\diff S
    = (x^2+yz)t+\frac{1}{3}t^3.\]
  然后 $(\star\star)$ 的解为
  \[\begin{split}
    u_2(x,y,z,t)
    & = \frac{1}{4\pi}\iiint_{r\leq t}\frac{2(\eta-t+r)}{r}\diff V \\
    & = \frac{1}{4\pi}\int_0^t\iint_{S_t(M)}\frac{2(\eta-t+r)}{r}\diff S\diff r \\
    & = \frac{1}{4\pi}\int_0^t\int_0^{\pi}\int_0^{2\pi}
      \frac{2(y+r\sin\theta\sin\varphi-t+r)}{r}r^2\sin\theta\diff\varphi\diff\theta\diff r \\
    & = -\frac{1}{3}t^3+yt^2.
  \end{split}\]
  所以原问题的解为
  \[u(x,y,z,t) = u_1(x,y,z,t)+u_2(x,y,z,t)=(x^2+yz)t+yt^2.\qedhere\]
\end{solve}


\begin{exercise}
	求解以下 Cauchy 问题:
	$$(1)\begin{cases}u_{tt}=4(u_{xx}+u_{yy}+u_{zz}),\\u|_{t=0}=0,\quad u_{t}|_{t=0}=\dfrac{1}{1+(x+y+z)^2};\end{cases}\quad(2)\begin{cases}u_{tt}=4(u_{xx}+u_{yy}+u_{zz}),\\u|_{t=0}=\sin x+\e^{2z},\quad u_{t}|_{t=0}=0;\end{cases}$$
\end{exercise}

\begin{solve}
	(1)作代换$r=x+y+z$, 则原问题变为
	\[\begin{cases}
		u_{tt}=12u_{rr}\\
		u|_{t=0}=0,\quad u_t|_{t=0}=\dfrac{1}{1+r^2}
	\end{cases}\]
	故可设齐次方程的解$u(r,t)=F(r-2\sqrt{3}t)+G(r+2\sqrt{3}t)$,其中 $F$, $G$ 均为单变量函数.
	
	代入初值条件,得
	\[\begin{cases}
		F(r)+G(r)=0\\
		-2\sqrt{3}F'(r)+2\sqrt{3}G'(r)=\frac{1}{1+r^2}
	\end{cases}\]
	解得
	\[\begin{cases}
		F(r)=-\frac{1}{4\sqrt{3}}\arctan r+C\\
		G(r)=\frac{1}{4\sqrt{3}}\arctan r-C
	\end{cases},\]
	其中 $C$ 为常数. 故
	$$u=\frac1{4\sqrt{3}}\left(\arctan{(x+y+z+2\sqrt{3}t)}-\arctan{(x+y+z-2\sqrt{3}t)}\right).$$
	
	(2)设$u_1,u_2$分别是如下两个问题的解
		\[\begin{cases}
			u_{tt}=4(u_{xx}+u_{yy}+u_{zz}),\\
			u|_{t=0}=\sin x,\quad u_{t}|_{t=0}=0;\end{cases}
		\quad
		\begin{cases}
			u_{tt}=4(u_{xx}+u_{yy}+u_{zz}),\\
			u|_{t=0}=\e^{2z},\quad u_{t}|_{t=0}=0.
		\end{cases}\]
	由三维泊松公式,
	\[u_1(x,t)=\frac{\partial}{\partial t}\left(\frac{1}{4\pi a^2t}\iint_{\partial B(M,at)}\sin\xi\d S\right)\]
	若作球面坐标代换,不妨令 $\xi=x+at\cos\theta$, 则
	\[\begin{aligned}
		u_1&={\frac{\partial}{\partial t}}\left({\frac{1}{4\pi a^{2}t}}\int_{0}^{2\pi}\int_{0}^{\pi}\sin(x+at\cos{\theta})a^2t^2\sin\theta\d\theta\d\varphi\right)\\
		&=\frac{\partial}{\partial t}\left(\frac{1}{2 a^{2}t}\int_{0}^{\pi}\sin(x+at\cos\theta)a^2t^2\sin\theta\d\theta\right).
	\end{aligned}\]
	作代换$\alpha=x+r\cos\theta$,则
	\[\begin{aligned}
		u_{1}& =\frac{\partial}{\partial t}\left(\frac{1}{4\pi a^{2}t}2\pi at\int_{x-at}^{x+at}\sin\alpha\mathrm{d}\alpha\right)=\frac{1}{2}\left(\sin\left(x+at\right)+\sin\left(x-at\right)\right),
		\end{aligned}\]
	类似地
	\[u_2(x,t)=\frac12\left(\e^{(z+at)}+\e^{(z-at)}\right).\]
	则解为
	\[\begin{aligned}
		u(x,y,z,t)&=u_{1}(x,y,z,t)+u_{2}(x,y,z,t) \\
		&=\frac12\left(\sin\left(x+at\right)+\sin\left(x-at\right)+\e^{\left(z+at\right)}+\e^{\left(z-at\right)}\right).
	\end{aligned}\]
\end{solve}
\section{波的传播与衰减}

\begin{exercise}
  试说明: 对一维波动方程所描述的波的传播过程一般具有后效现象.
\end{exercise}

\begin{solve}
  由教材 P12 分析知区间 $[x_1,x_2]$ 的影响区域为 $x_1-at\leq x\leq x_2+at$,
  故一旦扰动到达某一点,其对该点的影响将持续下去,因此一维波动方程所描述的波的传播过程具有后效现象.
\end{solve}


\begin{exercise}
  试说明: 对一维波动方程, 即使初始资料具有紧支集,
  当 $t\to +\infty$ 时其柯西问题的解没有衰减性.
\end{exercise}

\begin{solve}
  设初始资料 $\varphi$, $\psi$ 具有紧支集, 则存在一个常数 $\rho>0$,
  使得 $\varphi$, $\psi$ 在 $[-\rho,\rho]$ 外恒等于零,
  而在 $[-\rho,\rho]$ 内成立 $|\varphi|\leq C$, $|\psi|\leq C$, 那么对充分大的 $t$, 有
  \begin{align*}
    u(x,t)
    & = \frac{1}{2}\bigl(\varphi(x-at)
        +\varphi(x+at)\bigr)+\frac{1}{2a}\int_{x-at}^{x+at}\psi(\xi)\diff\xi \\
    & = \frac{1}{2a}\int_{-\rho}^{\rho}\psi(\xi)\diff\xi= \text{constant}.
  \end{align*}
  故一维波动方程柯西问题的解没有衰减性.
\end{solve}


\begin{exercise}
  设 $u$ 为初始资料 $\varphi$ 及 $\psi$ 具有紧支集的二维波动方程的解.
  试证明: 对任意固定的 $(x_0,y_0)\in \mathbb{R}^2$, 成立
  \[\lim_{t\to+\infty} u(x_0,y_0,t) = 0.\]
\end{exercise}

\begin{proof}
  For any fixed point $M=(x_0,y_0)\in\mathbb{R}^2$, there exists some $\rho>0$
  such that both $\varphi$ and $\psi$ vanish outside $\Sigma_\rho^M$ and are
  bounded in $\Sigma_\rho^M$.
  For sufficient large time $t$ such that $\Sigma_\rho^M\subset \Sigma_{at}^M$ we have
  \begin{align*}
    u(x_0,y_0,t) = {} 
    & \frac{1}{2\pi a}\biggl[\frac{\partial}{\partial t}
      \iint_{\Sigma_{at}^M}
      \frac{\varphi(\xi,\eta)\diff\xi\diff\eta}{\sqrt{a^2t^2-(\xi-x_0)^2-(\eta-y_0)^2}} \\
    & + \iint_{\Sigma_{at}^M}\frac{\psi(\xi,\eta)\diff\xi\diff\eta}
      {\sqrt{a^2t^2-(\xi-x_0)^2-(\eta-y_0)^2}}\biggr] \\
={} & \frac{1}{2\pi a}\bigg[\frac{\partial}{\partial t}\int_0^{at}\int_0^{2\pi}
      \frac{\varphi(x_0+r\cos\theta,y_0+r\sin\theta)}{\sqrt{a^2t^2-r^2}}r\diff\theta\diff r \\
    & +\int_0^{at}\int_0^{2\pi}\frac{\psi(x_0+r\cos\theta,y_0+r\sin\theta)}
      {\sqrt{a^2t^2-r^2}}r\diff\theta\diff r\bigg] \\
={} & \frac{1}{2\pi a}\bigg[\frac{\partial}{\partial t}
      \int_0^{\rho}\int_0^{2\pi}\frac{\varphi(x_0+r\cos\theta,y_0+r\sin\theta)}
      {\sqrt{a^2t^2-r^2}}r\diff\theta\diff r \\
    & + \int_0^{\rho}\int_0^{2\pi}\frac{\psi(x_0+r\cos\theta,y_0+r\sin\theta)}{\sqrt{a^2t^2-r^2}}r\diff\theta\diff r\bigg] \\
={} & \frac{1}{2\pi a}\bigg[\int_0^{\rho}\int_0^{2\pi}\frac{\partial}{\partial t}
      \frac{\varphi(x_0+r\cos\theta,y_0+r\sin\theta)}{\sqrt{a^2t^2-r^2}}r\diff\theta\diff r \\
    & + \int_0^{\rho}\int_0^{2\pi}\frac{\psi(x_0+r\cos\theta,y_0+r\sin\theta)}
      {\sqrt{a^2t^2-r^2}}r\diff\theta\diff r\bigg].
  \end{align*}
  Thus when $t\to +\infty$,
  \[\begin{split}
  |u(x_0,y_0,t)|&\leq \frac{1}{2\pi a}\left[2\pi C\int_0^{\rho}-a^2t(a^2t^2-r^2)^{-\frac{3}{2}}r\diff r+2\pi C\int_0^{\rho}\frac{r}{\sqrt{a^2t^2-r^2}}\diff r\right]\\
  &=\frac{1}{2\pi a}\left[2\pi C\left(a-\frac{a^2t}{\sqrt{a^2t^2-\rho^2}}\right)+2\pi C(at-\sqrt{a^2t^2-\rho^2})\right]\to 0,
  \end{split}\]
  i.e.,
  \[\lim_{t\to+\infty}u(x_0,y_0,t) = 0.\qedhere\]
\end{proof}


\section{能量不等式, 波动方程解的唯一性和稳定性}

\begin{note}[教材(6.15)式解释]
  第二个等式等价于
  \begin{align*}
        & \iint_{\varOmega}(u_xu_{xt}+u_yu_{yt})\diff x\diff y
          +\iint_{\varOmega}(u_{xx}u_t+u_{yy}u_t)\diff x\diff y \\
    ={} & \iint_{\varOmega}\left[\frac{\partial}{\partial x}(u_xu_t)
          +\frac{\partial}{\partial y}(u_yu_t)\right]\diff x\diff y
          =\int_{\varGamma}u_t(\nabla u\cdot\bm{n})\diff s.
  \end{align*}
  而由格林公式得
  \[\begin{split}\int_{\varGamma}u_t(\nabla u)\cdot\vec{n}\diff s&=\iint_{\varOmega}\nabla\cdot(u_t\nabla u)\diff x\diff y\\
  &=\iint_{\varOmega}\left(\frac{\partial}{\partial x}\bm{i}+\frac{\partial}{\partial y}\bm{j}\right)\left(u_tu_x\bm{i}+u_tu_y\bm{j}\right)\diff x\diff y\\
  &=\iint_{\varOmega}\left[\frac{\partial}{\partial x}(u_xu_t)+\frac{\partial}{\partial y}(u_yu_t)\right]\diff x\diff y.\end{split}\]
\end{note}

\begin{note}[定理6.2]
  由能量不等式得
  \begin{align*}
    E(t)+E_0(t)
    \leq{} & C\left(E(0)+E_0(0)+\int_0^T
      \iint_{\varOmega}(f_1-f_2)^2\diff x\diff y\diff t\right) \\
    ={} & C\biggl(\iint_{\varOmega}\left[v_t^2+a^2\left(v_x^2+v_y^2\right)\right]\bigm|_{t=0}
          \diff x\diff y + \iint_{\varOmega}v^2(x,y,0)\diff x\diff y \\
        & \quad + \int_0^T \iint_{\varOmega}( f_1-f_2)^2\diff x\diff y\diff t\biggr) \\
    ={} & C\bigl(\|\psi_1-\psi_2\|^2+a^2\|\varphi_{1x}-\varphi_{2x}\|^2
          + a^2\|\varphi_{1y}-\varphi_{2y}\|^2 \\
        & + \|\varphi_1-\varphi_2\|^2+\|f_1-f_2\|^2\bigr).
  \end{align*}
  因此初边值问题的解关于初始值 $(\varphi,\psi)$ 和方程右端项 $f$ 在定理所述意义下是稳定的.
\end{note}


\begin{exercise}
  对受摩擦力作用且具固定端点的有界弦振动, 满足方程
  \[u_{tt} = a^2u_{xx} - cu_t,\]
  其中常数 $c>0$, 证明其能量是减少的, 并由此证明方程
  \[u_{tt} = a^2u_{xx} - cu_t + f\]
  的初边值问题解的唯一性以及关于初始条件及自由项的稳定性.
\end{exercise}

\begin{proof}
  能量 $\displaystyle E(t)=\int_0^l\left(u_t^2+a^2u_x^2\right)\diff x$, 关于 $t$ 求导得
  \begin{align*}
    \frac{\diff E(t)}{\diff t}
    & = 2\int_0^l\left(u_tu_{tt}+a^2u_xu_{xt}\right)\diff x \\
    & = 2\int_0^l\left[u_t\left(u_{tt}-a^2u_{xx}\right)
        + a^2\frac{\partial}{\partial x}(u_tu_x)\right]\diff x \\
    & = -2\int_0^lcu_t^2\diff x+2a^2u_tu_x|_0^l=-2\int_0^lcu_t^2\diff x\leq 0.
  \end{align*}
  因此其能量是减少的.
  
  为了证明方程 $u_{tt}=a^2u_{xx}-cu_t+f$ 的初边值问题的解的唯一性, 设$u_1$,$u_2$为该方程的解,则$u=u_1-u_2$满足齐次定解问题
  \[\begin{cases}
    u_{tt}=a^2u_{xx}-cu_t, \\
    u(0,t)=u(l,t)=0, \\
    u(x,0)=u_t(x,0)=0.
  \end{cases}\]
  由能量不等式得
  \[0\leq E(t)\leq E(0)=\int_0^l\left[u_t^2(x,0)+a^2u_x^2(x,0)\right]\diff x = 0.\]
  故$E(t)=0\Rightarrow u_t=u_x=0\Rightarrow u(x,t)\equiv 0$.
  
  下面证明解对初始条件及自由项的稳定性:

  \textbullet 关于初始条件的稳定性. 记$\displaystyle E_0(t)=\int_0^lu^2(x,t)\diff x$,则
  \[\frac{\diff E_0(t)}{\diff t}
    = 2\int_0^luu_t\diff x\leq\int_0^lu^2\diff x+\int_0^lu_t^2\diff x\leq E_0(t)+E(t),\]
  然后用$\e^{-t}$乘上式两端得
  \[\frac{\d}{\d t}[\e^{-t}E_0(t)]\leq \e^{-t}E(t),\]
  再从$0$到$t$积分上式,得到
  \[E_0(t) \leq \e^tE_0(0)+\e^t\int_0^t\e^{-\tau}E(\tau)\diff\tau,\]
  又$E(\tau)\leq E(0)$,故
  \[E_0(t)\leq \e^tE_0(0)+\e^tE(0)\int_0^t\e^{-\tau}\diff\tau = \e^tE_0(0)+E(0)(\e^t-1).\]
  
  根据上式,当初值的均方模很小时,对固定的$T$, $0\leq t\leq T$时解的均方模也很小, 因此关于初始条件是稳定的.

  \textbullet 如有外力的作用, 此时定解问题为:
  \[\begin{cases}
    u_{tt}=a^2u_{xx}-cu_t+f, \\
    u(0,t)=u(l,t)=0, \\
    u(x,0)=u_t(x,0)=0.
  \end{cases}\]
  此时 $E(0)=E_0(0)=0$,且
  \[\begin{split}
    \frac{\diff E(t)}{\diff t}&=2\int_0^lu_t(-cu_t+f)\diff x=-2c\int_0^lu_t^2\diff x+2\int_0^lu_tf\diff x\\
    &\leq E(t)+\int_0^lf^2\diff x
  \end{split}\]
  \[\begin{split}
    &\Rightarrow E(t)\leq C_0\left(E(0)+\int_0^T\int_0^lf^2\diff x\diff t\right)=C_0\int_0^T\int_0^lf^2\diff x\diff t\\
    &\Rightarrow E_0(t)\leq \e^tE_0(0)+\e^t\int_0^t\e^{-\tau}E(\tau)\diff\tau\leq A\int_0^T\int_0^lf^2\diff x\diff t
    \end{split}\]
  故关于自由项是稳定的.
\end{proof}


\begin{exercise}
  证明函数 $f(x,t)$ 在 $G\colon 0\leq x\leq l, 0\leq t\leq T$ 作微小改变时, 方程
  \[\frac{\partial^2 u}{\partial t^2}
    = \frac{\partial}{\partial x}\biggl(k(x)\frac{\partial u}{\partial x}\biggr)
      -q(x)u + f(x,t)\]
  (其中 $k(x)>0$, $q(x)>0$ 和 $f(x,t)$ 都是一些充分光滑的函数)
  具固定端点边界条件的初边值问题的解在 $G$ 内的改变也是很微小的.
\end{exercise}

\begin{proof}
  令
  \[E(t)=\int_0^l\left(u_t^2+k(x)u_x^2+q(x)u^2\right)\diff x,
    \quad E_0(t)=\int_0^lu^2\diff x.\]
  则
  \[\begin{split}
    E'(t)
    & = 2\int_0^l(u_tu_{tt}+ku_xu_{xt}+quu_t)\diff x \\
    & = 2\int_0^lu_t\bigl(u_{tt}-(ku_x)_x+qu\bigr)\diff x+2(ku_tu_x)|_0^l \\
    & = 2\int_0^lu_tf\diff x\leq E(t)+\int_0^lf^2\diff x.
  \end{split}\]
  从 $0$ 到 $t$ 积分得
  \[E(t)\leq \e^tE(0)+\e^t\int_0^t\e^{-\tau}\int_0^lf^2(x,\tau)\diff x\diff\tau.\]
  又
  \[E'_0(t) = 2\int_0^l uu_t \diff x\leq E_0(t) + E(t).\]
  故
  \[E_0(t)\leq \e^t E_0(0) + \e^t\int_0^t \e^{-\tau} E(\tau) \diff\tau.\]
  设 $u(x,t)$ 为满足齐次初边值条件的解, 显然有 $E(0)=E_0(0)=0$.
  \[E_0(0) \leq C\int_0^T \int_0^l f^2 \diff x\diff t.\qedhere\]
\end{proof}


\begin{exercise}
  证明波动方程
  \[u_{tt} = a^2(u_{xx}+u_{yy}) + f(x,y,t)\]
  的自由项 $f$ 在 $L^2(K)$ 意义下作微小改变时, 对应的柯西问题的解 $u$ 在
  $L^2(K)$ 意义之下改变也是微小的, 其中 $K$ 是由 (6.30) 式所表示的锥体.
\end{exercise}

\begin{proof}
  作特征锥 $(x-x_0)^2+(y-y_0)^2\leq (R-at)^2$,
  记 $\Omega_t$ 为 $t=\text{const}$ 与锥的交截部分, 令
  \[E_1(\Omega_t)=\iint_{\Omega_t}\left(u_t^2+a^2(u_x^2+u_y^2)\right)\diff x\diff y,
    \quad E_0(\Omega_t)=\iint_{\Omega_t}u^2\diff x\diff y.\]
  关于 $E_1(\Omega_t)$ 求导并分布积分得
  \begin{align*}
    \frac{\diff E_1(\Omega_t)}{\diff t}
    ={} & 2\int_0^{R-at}\int_0^{2\pi r} u_t\left(u_{tt}-a^2(u_{xx}+u_{yy})\right)
          \diff s\diff r \\
        & + 2\int_{\Gamma_t} \left(a^2[u_xu_t\cos(n,x)+u_yu_t\cos(n,y)]
          - \frac{a}{2}[u_t^2+a^2(u_x^2+u_y^2)]\right)\diff s \\
    \leq{} & 2\iint_{\Omega_t} u_t f(x,y,t)\diff x\diff y \\
    \leq{} & \iint_{\Omega_t}u_t^2\diff x\diff y + \iint_{\Omega_t}f^2(x,y,t)\diff x\diff y 
          \leq E_1(\Omega_t) + \iint_{\Omega_t} f^2(x,y,t) \diff x\diff y.
  \end{align*}
  记 $\displaystyle F(t)=\iint_{\Omega_t} f^2(x,y,t) \diff x\diff y$, 则
  \[E_1(\Omega_t) \leq \e^t E_1(\Omega_0) + \e^t \int_0^t\e^{-\tau}F(\tau)\diff\tau.\]
  引进积分$\displaystyle E_0(\Omega_t)=\iint_{\Omega_t} u^2(x,y,t) \diff x\diff y$,则
  \[\begin{split}
    \frac{\diff E_0(\Omega_t)}{\diff t}
    & = -a\int_{\Gamma_t}u^2\diff s+2\iint_{\Omega}uu_t\diff x\diff y\leq E_0(\Omega_t)
      + E_1(\Omega_t) \\
    & \Rightarrow E_0(\Omega_t)\leq \e^tE_0(\Omega_0)
      + \e^t\int_0^t\e^{-\tau}E_1(\Omega_{\tau})\diff\tau.
  \end{split}\]
  为证明自由项的稳定性,考虑柯西问题
  \[\begin{cases}
    u_{tt} = a^2(u_{xx}+u_{yy})+f(x,y,t) \\
    u|_{t=0} = u_t|_{t=0} = 0.
  \end{cases}\]
  此时 $E_0(\Omega_0) = E_1(\Omega_0) = 0$, 故
  \[E_0(\Omega_t)\leq \e^t\int_0^t \int_0^{\tau} \e^{-\xi}F(\xi) \diff\xi\diff\tau.\]
  对上式从 $0$ 到 $\displaystyle T=\frac Ra$ 积分得
  \[\|u\|_{L^2(K)}^2\leq C\|f\|_{L^2(K)}^2.\qedhere\]
\end{proof}


\begin{exercise}
  固定端点有界弦的自由振动可以分解成各种不同固有频率的驻波(谐波)的叠加,
  试计算各个驻波的动能和位能, 并证明弦振动的总能量等于各个驻波能量的叠加.
  这个物理性质对应的数学事实是什么?
\end{exercise}

\begin{proof}
  由教材P21知此问题的解为
  \[u(x,t) = \sum_{k=1}^{\infty}u_k(x,t)
    = \sum_{k=1}^{\infty}N_k\cos(\omega_k t+\theta_k)\sin\frac{k\pi}{l}x.\]
  其中
  \[N_k = \sqrt{A_k^2+B_k^2}, \quad \omega_k=\frac{k\pi a}{l},
    \quad \cos\theta_k = \frac{A_k}{\sqrt{A_k^2+B_k^2}},
    \quad \sin\theta_k = \frac{B_k}{\sqrt{A_k^2+B_k^2}},\]
  \[A_k = \frac{2}{l}\int_0^l\varphi(\xi)\sin\frac{k\pi}{l}\xi\diff\xi,
  \quad B_k = \frac{2}{k\pi a}\int_0^l\psi(\xi)\sin\frac{k\pi}{l}\xi\diff\xi.\]
  第 $k$ 个驻波的能量为
  \[\begin{split}
    E_k
    & = \int_0^l\left((u_k)_t^2+a^2(u_k)_x^2\right)\diff x \\
    & = \omega_k^2N_k^2\int_0^l\left[\sin^2(\omega_kt+\theta_k)\sin^2\frac{k\pi}{l}x
        + \cos^2(\omega_kt+\theta_k)\cos^2\frac{k\pi}{l}x\right]\diff x \\
    & = \frac{1}{2}\omega_k^2N_k^2.
  \end{split}\]
  故
  \[\sum_{k=1}^{\infty} E_k = \frac{(\pi a)^2}{2l}\sum_{k=1}^{\infty}k^2N_k^2.\]
  另一方面,我们有
  \[u_t = -\sum_{k=1}^{\infty}\omega_kN_k\sin(\omega_kt+\theta_k)\sin\frac{k\pi}{l}x,\]
  \[u_x = \sum_{k=1}^{\infty}N_k\frac{k\pi}{l}\cos(\omega_kt+\theta_k)\cos\frac{k\pi}{l}x,\]
  故
  \begin{align*}
    E ={} & \int_0^l \left(u_t^2+a^2u_x^2\right)\diff x \\
      ={} & \sum_{k,j=1}^{\infty} \omega_k\omega_jN_kN_j\sin(\omega_kt
            +\theta_k)\sin(\omega_jt+\theta_j)
            \int_0^l \sin\frac{k\pi}{l}x\sin\frac{j\pi}{l}x\diff x \\
          & + \sum_{k,j=1}^{\infty} a^2\frac{kj\pi^2}{l^2}N_kN_j\cos(\omega_kt+\theta_k)
            \cos(\omega_jt+\theta_j) \int_0^l \cos\frac{k\pi}{l}x
            \cos\frac{j\pi}{l}x\diff x \\
      ={} & \frac{(\pi a)^2}{2l}\sum_{k=1}^{\infty}k^2N_k^2.
  \end{align*}
  因此
  \[E = \sum_{k=1}^{\infty}E_k.\]
  此事实反映了特征函数系的完备性, 即成立 Parseval 等式.
\end{proof}


\begin{exercise}
  考虑波动方程的第三类初边值问题
  \begin{align*}
    & u_{tt} - a^2(u_{xx}+u_{yy}) = 0,\quad t>0, (x,y)\in\varOmega, \\
    & u|_{t=0} = \varphi(x,y),\ u_t|_{t=0} = \psi(x,y), \\
    & \biggl(\frac{\partial u}{\partial \bm{n}}+\sigma u\biggr)\biggm|_{\varGamma} = 0,
  \end{align*}
  其中 $\sigma>0$ 是常数, $\varGamma$ 为 $\varOmega$ 的边界,
  $\bm{n}$ 是 $\varGamma$ 上的单位外法向量. 对于上述定解问题的解, 定义能量积分
  \[E(t) = \iint_{\varOmega} \bigl(u_t^2+a^2(u_x^2+u_y^2)\bigr)\diff x\diff y
    + a^2\int_{\varGamma} \sigma u^2\diff s,\]
  试证明 $E(t)$ 为常数, 并由此说明上述定解问题解的唯一性.
\end{exercise}

\begin{proof}
  直接求导得
  \begin{align*}
    \frac{\partial E(t)}{\partial t}
    ={} & 2\iint_{\varOmega} \bigl(u_t u_{tt} + a^2(u_x u_{xt} + u_y u_{yt})\bigr)
          \diff x\diff y + 2a^2\int_{\varGamma} \sigma uu_t \diff s \\
    ={} & 2\iint_{\varOmega} u_t(u_{tt}-a^2(u_{xx}+u_{yy}))
          + a^2(u_x u_t)_x + a^2(u_y u_t)_y \diff x\diff y \\
        & + 2a^2\int_{\varGamma} \sigma uu_t \diff s \\
    ={} & 2a^2\iint_{\varOmega} \div (u_t\nabla u) \diff x\diff y
          + 2a^2\int_{\varGamma} \sigma uu_t \diff s \\
    ={} & 2a^2\int_{\varGamma} u_t \biggl(\frac{\partial u}{\partial \bm{n}}+\sigma u\biggr)
          \diff s = 0,
  \end{align*}
  故 $E(t)$ 为常数. 由此立即可得解的唯一性.
\end{proof}